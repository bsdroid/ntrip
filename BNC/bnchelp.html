<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<h3>BKG Ntrip Client (BNC) Version 2.4 Manual</h3>

<p>
The BKG Ntrip Client (BNC) is a program for simultaneously retrieving, decoding and converting real-time GNSS data streams from NTRIP broadcasters like <u>http://www.euref-ip.net/home</u> or <u>http://www.igs-ip.net/home</u> or <u>http://products.igs-ip.net/home</u>.
</p>

<p>
BNC has been developed for the Federal Agency for Cartography and Geodesy (BKG) within the framework of EUREF's Real-time GNSS Project (EUREF-IP, IP for Internet Protocol) and the Real-Time IGS Pilot Project (RTIGS).
</p>

<p>
BNC has been written under GNU General Public License (GPL). Binaries for BNC are available for Windows, 32-bit Linux, 64-bit Linux (compiled under -m32 32-bit compatibility mode), Solaris, and Mac systems. We used the MinGW Version 5.1.3 compiler to create the Windows binary. It is likely that BNC can be compiled on other systems where a GNU compiler and Qt Version 4.5.2 are installed.
</p>

<p>
Please ensure that you have installed the latest version of BNC available from <u>http://igs.bkg.bund.de/ntrip/download</u>. We are continuously working on the program and would appreciate if you could send any comments, suggestions, or bug reports to [euref-ip@bkg.bund.de] or [igs-ip@bkg.bund.de].
</p>

<h3>Contents</h3>
<p>
<h4>
<a href=#purpose>1. Purpose</a><br>
<a href=#resources>2. Modes &amp; Resources</a><br>
<a href=#options>3. Settings &amp; Handling</a><br>
<a href=#limits>4. Limitations &amp; Known Bugs</a><br>
<a href=#authors>5. Authors</a><br>
<a href=#annex>6. Annex</a><br>
</h4>
</p>

<p><a name="purpose"><h3>1. Purpose</h3></p>

<p> The purpose of BNC is to

<ul>
<li>retrieve real-time GNSS data streams available through NTRIP transport protocol,</li>
<li>retrieve real-time GNSS data streams via TCP directly from an IP address without using the NTRIP transport protocol, and/or</li>
<li>retrieve real-time GNSS data streams from a local UDP or serial port without using the NTRIP transport protocol, and/or</li>
<li>generate high-rate RINEX Observation and Navigation files to support near real-time GNSS post-processing applications, and/or</li> 
<li>generate ephemeris and synchronized or unsynchronized observations epoch by epoch through an IP port to support real-time GNSS network engines, and/or</li> 
<li>generate clock and orbit corrections to broadcast ephemeris through an IP port to support real-time Precise Point Positioning on GNSS rovers, and/or</li> 
<li>generate synchronized clock and orbit corrections to broadcast ephemeris epoch by epoch through an IP port to support the combination of such streams as coming simultaneously from various correction providers, and/or</li> 
<li>monitor the performance of a network of real-time GNSS data streams to generate advisory notes in case of outages or corrupted streams, and/or</li>
<li>scan RTCM streams for incoming antenna information as well as message types and their repetition rates, and/or</li>
<li>feed a stream into a GNSS receiver via serial communication link, and/or</li>
<li>carry out a real-time Precise Point Positioning to determine a GNSS rover position.</li>
</ul>
</p>

<p>
BNC supports decoding the following GNSS data formats:
</p>
<p>
<ul>
<li>RTCM Version 2.x containing message types 18 and 19 or 20 and 21 together with 3 and 22 (GPS and GLONASS), </li> 
<li>RTCM Version 3.x containing message types 1002 (GPS, SBAS) or 1004 (GPS), 1010 or 1012 (GLONASS), 1019 or 1020 (broadcast ephemeris), 1057-1068 (premature State Space Representation messages for GPS and GLONASS)</li>
<li>RTIGS containing GPS record types 200 (observations) and 300 (ephemeris).</li>
</ul>
BNC allows to by-pass its decoding and conversion algorithms, leave whatever is received untouched and save it in files.
</p>

<p>
The first of the following figures shows a flow chart of BNC connected to a GNSS receiver via serial or TCP communication link for the pupose of Precise Point Positioning. The second figure shows the conversion of RTCM streams to RINEX batches. The third figure shows a flow chart of BNC feeding a real-time GNSS engine. The engine then estimates satellite orbit and clock correctors. The 'BKG Ntrip Server' (BNS) is used in this scenario to encode correctors to RTCMv3.
</p>
<p><img src=":bnchelp/screenshot10.png"/></p>
<p><u>Figure:</u> Flowchart, BNC connected to a GNSS receiver for Precise Point Positioning.</p>

<p>
</p>
<p><img src=":bnchelp/screenshot01.png"/></p>
<p><u>Figure:</u> Flowchart, BNC converting RTCM streams to RINEX batches.</p>

<p>
</p>
<p><img src=":bnchelp/screenshot02.png"/></p>
<p><u>Figure:</u> Flowchart, BNC feeding a real-time GNSS engine.</p>


<p><a name="resources"><h3>2. Modes &amp; Resources</h3></p>
<p>
Although BNC is a real-time tool to be operated in online mode, it can be run offline for post-processing of data made availabe from a single file. Furthermore, apart from its regular window mode, BNC can be run as a batch/background job in a 'no window' mode using processing options from a previously saved configuration.
</p>
<p>
Unless in offline mode, BNC
</p>
<ul>
<li>requires access to the Internet with a minimum of about 2 to 6 kbits/sec per stream depending on the stream format and the number of visible satellites. You need to make sure that the connection can sustain the required bandwidth.</li>
<li>requires the clock of the host computer to be properly synchronized.</li>
<li>has the capacity to retrieve hundreds of GNSS data streams simultaneously. Please be aware that such usage may incur a heavy load on the NTRIP broadcaster side depending on the number of streams requested. We recommend limiting the number of streams where possible to avoid unnecessary workload.</li>
</ul>
</p>

<p>
The main window of BNC shows a top menu bar section, a sections for tabs to set processing options, a 'Streams' section and a section for 'Log' tabs, and a bottom menu bar section, see figure below.
</p>
<p><img src=":bnchelp/screenshot09.png"/></p>
<p><u>Figure:</u> Sections on BNC's main window.</p>


<p><a name="options"><h3>3. Settings &amp; Handling</h3></p>
<p>
This chapter describes BNC's settings and how to handle the program. It explains the top menu bar, the processing options, the 'Streams' and 'Log' sections, and the bottom menu bar.
</p>

<p>
The usual handling of BNC is that you first select a number of streams ('Add Stream'). Any stream configured to BNC shows up on the 'Streams' canvas in the middle of BNC's main window. You then go through BNC's various configuration tabs to select a combination of input, processing and output options before you start the program ('Start'). Records of BNC's activities are shown in the 'Log' tab. The bandwidth consumption per stream, the latency of incoming observations and PPP time series for coordinate components are shown in the 'Throughput', 'Latency' and 'PPP Plot' tabs of the main window.
</p>
<p>
As a default, configuration files for running BNC on Unix/Linux/Mac systems are saved in directory '${HOME}/.config/BKG'. On Windows systems, they are typically saved in directory 'C:/Documents and Settings/Username/.config/BKG'. The default configuration file name is 'BNC.ini'.</p>
<p>
The default file name 'BNC.ini' can be changed and the file contents can easily be edited. On graphical user interfaces it is possible to Drag &amp; Drop a configuration file icon to start BNC (not on Mac systems). Some configuration options can be changed on-the-fly. See annexed 'Configuration Example' for a complete set of configuration options.
</p>
<p>
3.1. <a href=#topmenu>Top Menu Bar</a><br>
3.1.1 <a href=#file>File</a><br>
3.1.2 <a href=#help>Help</a><br><br>
3.2. <a href=#proxy>Proxy</a><br>
3.3. <a href=#general>General</a><br>
&nbsp; &nbsp; &nbsp; 3.3.1. <a href=#genlog>Logfile</a><br>
&nbsp; &nbsp; &nbsp; 3.3.2. <a href=#genapp>Append Files</a><br>
&nbsp; &nbsp; &nbsp; 3.3.3. <a href=#genconf>Reread Configuration</a><br>
&nbsp; &nbsp; &nbsp; 3.3.4. <a href=#genstart>Auto Start</a><br>
&nbsp; &nbsp; &nbsp; 3.3.5. <a href=#rawout>Raw Output File</a><br>
3.4. <a href=#rinex>RINEX Observations</a><br>
&nbsp; &nbsp; &nbsp; 3.4.1. <a href=#rnxname>File Names</a><br>
&nbsp; &nbsp; &nbsp; 3.4.2. <a href=#rnxdir>Directory</a><br>
&nbsp; &nbsp; &nbsp; 3.4.3. <a href=#rnxinterval>File Interval</a><br>
&nbsp; &nbsp; &nbsp; 3.4.4. <a href=#rnxsample>Sampling</a><br>
&nbsp; &nbsp; &nbsp; 3.4.5. <a href=#rnxskl>Skeleton Extension</a><br>
&nbsp; &nbsp; &nbsp; 3.4.6. <a href=#rnxscript>Script</a><br>
&nbsp; &nbsp; &nbsp; 3.4.7. <a href=#rnxvers>Version</a><br>
3.5. <a href=#ephemeris>RINEX Ephemeris</a><br>
&nbsp; &nbsp; &nbsp; 3.5.1. <a href=#ephdir>Directory</a><br>
&nbsp; &nbsp; &nbsp; 3.5.2. <a href=#ephint>Interval</a><br>
&nbsp; &nbsp; &nbsp; 3.5.3. <a href=#ephport>Port</a><br>
&nbsp; &nbsp; &nbsp; 3.5.4. <a href=#ephvers>Version</a><br>
3.6. <a href=#correct>Broadcast Corrections</a><br>
&nbsp; &nbsp; &nbsp; 3.6.1. <a href=#corrdir>Directory</a><br>
&nbsp; &nbsp; &nbsp; 3.6.2. <a href=#corrint>Interval</a><br>
&nbsp; &nbsp; &nbsp; 3.6.3. <a href=#corrport>Port</a><br>
&nbsp; &nbsp; &nbsp; 3.6.4. <a href=#corrwait>Wait for Full Epoch</a><br>
3.7. <a href=#syncout>Feed Engine</a><br>
&nbsp; &nbsp; &nbsp; 3.7.1. <a href=#syncport>Port</a><br>
&nbsp; &nbsp; &nbsp; 3.7.2. <a href=#syncwait>Wait for Full Epoch</a><br>
&nbsp; &nbsp; &nbsp; 3.7.3. <a href=#syncsample>Sampling</a><br>
&nbsp; &nbsp; &nbsp; 3.7.4. <a href=#syncfile>File</a><br>
&nbsp; &nbsp; &nbsp; 3.7.5. <a href=#syncuport>Port (unsynchronized)</a><br>
3.8. <a href=#serial>Serial Output</a><br>
&nbsp; &nbsp; &nbsp; 3.8.1. <a href=#sermount>Mountpoint</a><br>
&nbsp; &nbsp; &nbsp; 3.8.2. <a href=#serport>Port Name</a><br>
&nbsp; &nbsp; &nbsp; 3.8.3. <a href=#serbaud>Baud Rate</a><br>
&nbsp; &nbsp; &nbsp; 3.8.4. <a href=#serflow>Flow Control</a><br>
&nbsp; &nbsp; &nbsp; 3.8.5. <a href=#serparity>Parity</a><br>
&nbsp; &nbsp; &nbsp; 3.8.6. <a href=#serdata>Data Bits</a><br>
&nbsp; &nbsp; &nbsp; 3.8.7. <a href=#serstop>Stop Bits</a><br>
&nbsp; &nbsp; &nbsp; 3.8.8. <a href=#serauto>NMEA</a><br>
&nbsp; &nbsp; &nbsp; 3.8.9. <a href=#serfile>File</a><br>
&nbsp; &nbsp; &nbsp; 3.8.10. <a href=#serheight>Height</a><br>
3.9. <a href=#advnote>Outages</a><br>
&nbsp; &nbsp; &nbsp; 3.9.1. <a href=#obsrate>Observation Rate</a><br>
&nbsp; &nbsp; &nbsp; 3.9.2. <a href=#advfail>Failure Threshold</a><br>
&nbsp; &nbsp; &nbsp; 3.9.3. <a href=#advreco>Recovery Threshold</a><br>
&nbsp; &nbsp; &nbsp; 3.9.4. <a href=#advscript>Script</a><br>
3.10. <a href=#misc>Miscellaneous</a><br>
&nbsp; &nbsp; &nbsp; 3.10.1. <a href=#miscmount>Mountpoint</a><br>
&nbsp; &nbsp; &nbsp; 3.10.2. <a href=#miscperf>Log Latency</a><br>
&nbsp; &nbsp; &nbsp; 3.10.3. <a href=#miscscan>Scan RTCM</a><br>
3.11. <a href=#pppclient>PPP Client</a><br>
&nbsp; &nbsp; &nbsp; 3.11.1 <a href=#pppmount>Mountpoint</a><br>
&nbsp; &nbsp; &nbsp; 3.11.2 <a href=#pppopt>Options</a><br>
&nbsp; &nbsp; &nbsp; 3.11.2.1 <a href=#pppstatic>Static</a><br>
&nbsp; &nbsp; &nbsp; 3.11.2.2 <a href=#pppphase>Use Phase Obs</a><br>
&nbsp; &nbsp; &nbsp; 3.11.2.3 <a href=#ppptropo>Estimate Tropo</a><br>
&nbsp; &nbsp; &nbsp; 3.11.2.4 <a href=#pppglo>Use GLONASS</a><br>
&nbsp; &nbsp; &nbsp; 3.11.3 <a href=#pppoptcont>Options cont'd</a><br>
&nbsp; &nbsp; &nbsp; 3.11.3.1 <a href=#pppsigma>Sigma Code</a><br>
&nbsp; &nbsp; &nbsp; 3.11.3.2 <a href=#pppaverage>Averaging</a><br>
&nbsp; &nbsp; &nbsp; 3.11.4 <a href=#ppporigin>Origin</a><br>
&nbsp; &nbsp; &nbsp; 3.11.5 <a href=#pppnmeaout>NMEA</a><br>
&nbsp; &nbsp; &nbsp; 3.11.5.1 <a href=#pppnmeafile>File</a><br>
&nbsp; &nbsp; &nbsp; 3.11.5.2 <a href=#pppnmeaport>Port</a><br><br>
3.12. <a href=#streams>Streams</a><br>
&nbsp; &nbsp; &nbsp; 3.12.1 <a href=#streamedit>Edit Streams</a><br>
&nbsp; &nbsp; &nbsp; 3.12.2 <a href=#streamdelete>Delete Stream</a><br>
&nbsp; &nbsp; &nbsp; 3.12.3 <a href=#streamconf>Reconfigure Streams On-the-fly</a><br><br>
3.13. <a href=#logs>Logging</a><br>
&nbsp; &nbsp; &nbsp; 3.13.1 <a href=#logfile>Log</a><br>
&nbsp; &nbsp; &nbsp; 3.13.2 <a href=#throughput>Throughput</a><br>
&nbsp; &nbsp; &nbsp; 3.13.3 <a href=#latency>Latency</a><br>
&nbsp; &nbsp; &nbsp; 3.13.4 <a href=#ppptab>PPP Plot</a><br><br>
3.14. <a href=#bottom>Bottom Menu Bar</a><br>
&nbsp; &nbsp; &nbsp; 3.14.1. <a href=#streamadd>Add Stream - Coming from Caster</a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.14.1.1 <a href=#streamhost>Caster Host and Port</a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.14.1.2 <a href=#streamtable>Casters Table</a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.14.1.3 <a href=#streamuser>User and Password</a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.14.1.4 <a href=#gettable>Get Table</a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.14.1.5 <a href=#ntripv>NTRIP Version</a><br>
&nbsp; &nbsp; &nbsp; 3.14.2 <a href=#streamip>Add Stream - Coming from TCP/IP Port</a><br>
&nbsp; &nbsp; &nbsp; 3.14.3 <a href=#streamudp>Add Stream - Coming from UDP Port</a><br>
&nbsp; &nbsp; &nbsp; 3.14.4 <a href=#streamser>Add Stream - Coming from Serial Port</a><br>
&nbsp; &nbsp; &nbsp; 3.14.5 <a href=#start>Start</a><br>
&nbsp; &nbsp; &nbsp; 3.14.6 <a href=#stop>Stop</a><br><br>
3.15. <a href=#cmd>Command Line Options</a><br>
&nbsp; &nbsp; &nbsp; 3.15.1. <a href=#nw>No Window Mode</a><br>
&nbsp; &nbsp; &nbsp; 3.15.2. <a href=#post>Offline Mode</a><br>
&nbsp; &nbsp; &nbsp; 3.15.3. <a href=#conffile>Configuration File</a><br>
</p>

<p><a name="topmenu"><h4>3.1. Top Menu Bar</h4></p>
<p>
The top menu bar allows to select a font for the BNC windows, save configured options or quit the program execution. It also provides access to a program documentation.
</p>

<p><a name="file"><h4>3.1.1 File</h4></p>

<p>
The 'File' button lets you
<ul>
<li> select an appropriate font.<br>
Use smaller font size if the BNC main window exceeds the size of your screen.
</li> 
<li> save selected options in configuration file.<br>
When using 'Save &amp; Reread Configuration' while BNC is already processing data, some configuration options become immediately effective on-the-fly without interrupting uninvolved threads. See annexed section 'Configuration Example' for a list of on-the-fly changeable configuration options.
</li>
<li> quit the BNC program.
</li> 
</ul>
</p>

<p><a name="help"><h4>3.1.2 Help</h4></p>

<p>
The 'Help' button provides access to
<ul>
<li>
help contents.<br>
You may keep the 'Help Contents' window open while configuring BNC.
</li> 
<li>
a 'Flow Chart' showing BNC linked to a real-time GNSS network engine such as RTNet.
</li>
<li>
general information about BNC.<br>
Close the 'About BNC' window to continue working with BNC.
</li> 
</ul>
</p>
<p>
BNC comes with a help system providing online information about its functionality and usage. Short descriptions are available for any widget. Focus to the relevant widget and press Shift+F1 to request help information. A help text appears immediately; it disappears as soon as the user does something else. The dialogs on some operating systems may provide a &quot;?&quot; button that users can click; they then click the relevant widget to pop up the help text.
</p>

<p><a name="proxy"><h4>3.2. Proxy - for usage in a protected LAN</h4></p>

<p>
If you are running BNC within a protected Local Area Network (LAN), you might need to use a proxy server to access the Internet. Enter your proxy server IP and port number in case one is operated in front of BNC. If you don't know the IP and port of your proxy server, check the proxy server settings in your Internet browser or ask your network administrator.</p>
<p>
Note that IP streaming is often not allowed in a LAN. In this case you need to ask your network administrator for an appropriate modification of the local security policy or for the installation of a TCP relay to the NTRIP broadcasters. If these are not possible, you might need to run BNC outside your LAN on a host that has unobstructed connection to the Internet.
</p>
<p><a name="general"><h4>3.3. General</h4></p>
<p>
The following defines general settings for BNC's logfile, file handling, reconfiguration on-the-fly, and auto-start.
</p>

<p><a name="genlog"><h4>3.3.1 Logfile - optional</h4></p>
<p>
Records of BNC's activities are shown in the 'Log' tab on the bottom of the main window. These logs can be saved into a file when a valid path is specified in the 'Logfile (full path)' field. The logfile name will automatically be extended by a string '_YYMMDD' carrying the current date. This leads to series of daily logfiles when running BNC continuously for extended. Message logs cover the communication status between BNC and the NTRIP broadcaster as well as problems that may occur in the communication link, stream availability, stream delay, stream conversion etc. All times are given in UTC. The default value for 'Logfile (full path)' is an empty option field, meaning that BNC logs will not saved into a file.
</p>

<p><a name="genapp"><h4>3.3.2 Append Files - optional</h4></p>
<p>
When BNC is started, new files are created by default and any existing files with the same name will be overwritten. However, users might want to append existing files following a restart of BNC, a system crash or when BNC crashed. Tick 'Append files' to continue with existing files and keep what has been recorded so far. Note that option 'Append files' affects all types of files created by BNC.
</p> 

<p><a name="genconf"><h4>3.3.3 Reread Configuration - optional</h4></p>
<p>
When operating BNC online in 'no window' mode (command line option -nw), some configuration options can nevertheless be changed on-the-fly without interrupting the running process. For that you force the program to reread parts of its configuration in pre-defined intervals from the disk. Select '1 min', '1 hour', or '1 day' to let BNC reread on-the-fly changeable configuration options every full minute, hour, or day. This lets in between edited options become effective without interrupting uninvolved threads. See annexed section 'Configuration Example' for a configuration file example and a list of on-the-fly changeable options.
</p> 

<p><a name="genstart"><h4>3.3.4 Auto Start - optional</h4></p>
<p>
You may like to auto-start BNC at startup time in window mode with pre-assigned configuration options. This may be required i.e. immediately after booting your system. Tick 'Auto start' to supersede the usage of the 'Start' button. Make sure that you maintain a link to BNC for that in your Autostart directory (Windows systems) or call BNC in a script below directory /etc/init.d (Unix/Linux/Mac systems).
</p>
<p>
 See BNC's command line option -nw for an auto-start of BNC in 'no window' mode.
</p>

<p><a name="rawout"><h4>3.3.5 Raw Output File - optional</h4></p>
<p>
BNC can save all data coming in through various streams in the received order and format together in one single daily file. This is of importance i.e. when using the PPP option in offline mode where the contents of different streams carrying observations, orbit/clock correctors, and broadcast ephemeris are to be read from one file. Data will be saved in blocks in the received format seperated by ASCII records like (example):
<pre>
2010-08-03T18:05:28 RTCM3EPH RTCM_3 67
</pre>
This example block header tells you that 67 bytes are saved in the data block following this record. The information in this block is encoded in RTCM Version 3.x format, comes from Mountpoint RTCM3EPH and was received at 18:05:29 UTC on 2010-08-03. BNC adds its own time stamps because a complete time reference may not be provided for all incoming observations and epochs.
</p>
<p>
Note that streams in a 'Raw output file' which shall later be used in an offline PPP calculation must all be encoded in the same format.
</p>
<p>
The default value for 'Raw output file (full path)' is an empty option field, meaning that BNC will not save raw data into a daily file.
</p>

<p><a name="rinex"><h4>3.4. RINEX Observations</h4></p>
<p>
Observations will be converted to RINEX if they come in either RTCM Version 2.x, RTCM Version 3.x, or RTIGS format. BNC's RINEX Observation files generally contain C1, C2, P1, P2, L1, L2, S1, and S2 observations. In case an observation is unavailable, its value is set to zero '0.000'. Note that the 'RINEX TYPE' field in the RINEX Observation file header is always set to 'M(MIXED)' even if the file does not contain any GLONASS or SABAS data.
</p> 

<p>
The screenshot below shows an example setup of BNC when converting streams to RINEX. Streams are coming in from various NTRIP broadcasters as well as via a plain UDP and a serial communication link. Decoder 'ZERO' has been selected for one stream to not convert its contents but save it in original format.
</p>
<p><img src=":bnchelp/screenshot16.png"/></p>
<p><u>Figure:</u> BNC translating incoming streams to 15 min RINEX Version 3 files.</p>

<p><a name="rnxname"><h4>3.4.1 RINEX File Names</h4></p>
<p>
RINEX file names are derived by BNC from the first 4 characters of the corresponding stream's mountpoint (4Char Station ID). For example, data from mountpoints FRANKFURT and WETTZELL will have hourly RINEX Observation files named</p>
<p>
FRAN{ddd}{h}.{yy}O<br>
WETT{ddd}{h}.{yy}O
</p>
<p>
where 'ddd' is the day of year, 'h' is a letter which corresponds to an hour long UTC time block and 'yy' is the year. 
</p>
<p>
If there are more than one stream with identical 4Char Station ID (same first 4 characters for their mountpoints), the mountpoint strings are split into two sub-strings and both become part of the RINEX file name. For example, when simultaneously retrieving data from mountpoints FRANKFURT and FRANCE, their hourly RINEX Observation files are named as</p>
<p>
FRAN{ddd}{h}_KFURT.{yy}O<br>
FRAN{ddd}{h}_CE.{yy}O.
</p>
<p>
If several streams show exactly the same mountpoint name (example: BRUS0 from <u>www.euref-ip.net</u> and BRUS0 from <u>www.igs-ip.net</u>), BNC adds an integer number to the file name leading i.e. to hourly RINEX Observation files like</p>
<p>
BRUS{ddd}{h}_0.{yy}O<br>
BRUS{ddd}{h}_1.{yy}O.
</p>
<p>
Note that RINEX file names for all intervals less than 1 hour follow the file name convention for 15 minutes RINEX Observation files i.e.</p>
<p>
FRAN{ddd}{h}{mm}.{yy}O
</p>
<p>
where 'mm' is the starting minute within the hour.
</p>

<p><a name="rnxdir"><h4>3.4.2 Directory - optional</h4></p>
<p>
Here you can specify the path to where the RINEX Observation files will be stored. If the specified directory does not exist, BNC will not create RINEX Observation files. Default value for 'Directory' is an empty option field, meaning that no RINEX Observation files will be written.
</p> 

<p><a name="rnxinterval"><h4>3.4.3 File Interval - mandatory if 'Directory' is set</h4></p>
<p>
Select the length of the RINEX Observation file generated. The default value is 15 minutes.
</p> 

<p><a name="rnxsample"><h4>3.4.4 Sampling - mandatory if 'Directory' is set </h4></p>
<p>
Select the RINEX Observation sampling interval in seconds. A value of zero '0' tells BNC to store all received epochs into RINEX. This is the default value.
</p> 

<p><a name="rnxskl"><h4>3.4.5 Skeleton Extension - optional</h4></p>
<p>
Whenever BNC starts generating RINEX Observation files (and then once every day at midnight), it first tries to retrieve information needed for RINEX headers from so-called public RINEX header skeleton files which are derived from sitelogs. A HTTP link to a directory containing these skeleton files may be available through data field number 7 of the affected NET record in the source-table. See <u>http://www.epncb.oma.be:80/stations/log/skl/brus.skl</u> for an example of a public RINEX header skeleton file for the Brussels EPN station. 
</p>
<p>
However, sometimes public RINEX header skeleton files are not available, its contents is not up to date, or you need to put additional/optional records in the RINEX header. For that BNC allows using personal skeleton files that contain the header records you would like to include. You can derive a personal RINEX header skeleton file from the information given in an up to date sitelog. A file in the RINEX Observations 'Directory' with a 'Skeleton extension' suffix is interpreted by BNC as a personal RINEX header skeleton file for the corresponding stream.
</p>
<p>
Examples for personal skeleton file name convention: RINEX Observation files for mountpoints WETTZELL, FRANKFURT and FRANCE (same 4Char Station ID), BRUS0 from <u>www.euref-ip.net</u> and BRUS0 from <u>www.igs-ip.net</u> (same 4Char Station ID, identical mountpoint stings) would accept personal skeleton files named</p>
<p>
WETT.skl<br>
FRAN_KFURT.skl<br>
FRAN_CE.skl<br>
BRUS_0.skl<br>
BRUS_1.skl</p>
<p>
if 'Skeleton extension' is set to 'skl'.
</p> 
<p> 
Note the following regulations regarding personal RINEX header skeleton files:
<ul>
<li>If such a file exists in the 'RINEX directory', the corresponding public RINEX header skeleton file is ignored. The RINEX header is generated solely from the contents of the personal skeleton.</li>
<li>Personal skeletons should contain a complete first header record of type</li>
<br>- &nbsp; RINEX VERSION / TYPE
<li>They should then contain an empty header record of type</li>
<br>- &nbsp; PGM / RUN BY / DATE
<br>BNC will complete this line and include it in the actual RINEX file header.
<li>They should further contain complete header records of type</li>
<br>- &nbsp; MARKER NAME
<br>- &nbsp; OBSERVER / AGENCY
<br>- &nbsp; REC # / TYPE / VERS
<br>- &nbsp; ANT # / TYPE
<br>- &nbsp; APPROX POSITION XYZ
<br>- &nbsp; ANTENNA: DELTA H/E/N
<br>- &nbsp; WAVELENGTH FACT L1/2
<li>They may contain any other optional complete header record as defined in the RINEX documentation.</li>
<li>They should then contain empty header records of type</li>
<br>- &nbsp; # / TYPES OF OBSERV
<br>- &nbsp; TIME OF FIRST OBS
<br>BNC will include these lines in the final RINEX file header together with an additional
<br>- &nbsp; COMMENT 
<br>line describing the source of the stream.
<li>They should finally contain an empty header record of type</li>
<br>- &nbsp; END OF HEADER (last record)
</ul>
<p>
If neither a public nor a personal RINEX header skeleton file is available for BNC, a default header will be used.
</p>

<p><a name="rnxscript"><h4>3.4.6 Script - optional</h4></p>
<p>
Whenever a RINEX Observation file is saved, you might want to compress, copy or upload it immediately via FTP. BNC allows you to execute a script/batch file to carry out these operations. To do that specify the full path of the script/batch file here. BNC will pass the RINEX Observation file path to the script as a command line parameter (%1 on Windows systems, $1 on Unix/Linux/Mac systems).
</p> 
<p> 
The triggering event for calling the script or batch file is the end of a RINEX Observation  file 'Interval'. If that is overridden by a stream outage, the triggering event is the stream reconnection.
</p> 
<p> 
As an alternative to initiating file uploads through BNC, you may like to call an upload script or batch file through your crontable or Task Scheduler (independent from BNC) once every 2 or 3 minutes after the end of each RINEX file 'Interval'.
</p> 

<p><a name="rnxvers"><h4>3.4.7 Version - optional</h4></p>
<p>
The default format for RINEX Observation files is RINEX Version 2.11. Select 'Version 3' if you would like to save observations in RINEX Version 3 format.
</p> 

<p><a name="ephemeris"><h4>3.5. RINEX Ephemeris</h4></p>
<p>
Broadcast ephemeris can be saved as RINEX Navigation files when received via RTCM Version 3.x as message types 1019 (GPS) and 1020 (GLONASS) or via RTIGS records type 300. The file name convention follows the details given in section 'RINEX File Names' except that the first four characters are 'BRDC' and the last character is
</p>
<ul>
<li>'N' or 'G' for GPS or GLONASS ephemeris in two separate RINEX Version 2.11 Navigation files, or</li>
<li>'P' for GPS plus GLONASS ephemeris saved together in one RINEX Version 3 Navigation file.
</ul> 

<p>
Note that streams dedicated to carry Broadacst Ephemeris messages in RTCM v3 format in high repetition rates are listed on <u>http://igs.bkg.bund.de/ntrip/ephemeris</u>.
</p>

<p><a name="ephdir"><h4>3.5.1 Directory - optional</h4></p>
<p>
Specify the path for saving broadcast ephemeris data as RINEX Navigation files. If the specified directory does not exist, BNC will not create RINEX Navigation files. Default value for Ephemeris 'Directory' is an empty option field, meaning that no RINEX Navigation files will be created.
</p> 

<p><a name="ephint"><h4>3.5.2 Interval - mandatory if 'Directory' is set</h4></p>
<p>
Select the length of the RINEX Navigation file generated. The default value is 1 day.
</p> 

<p><a name="ephport"><h4>3.5.3 Port - optional</h4></p>
<p>
BNC can output broadcast ephemeris in RINEX Version 3 ASCII format on your local host (IP 127.0.0.1) through an IP 'Port'. This function is introduced in order to support i.e. the 'BKG Ntrip Sate Space Server' (BNS) which transforms IGS clocks and orbits into corrections to broadcast ephemeris. Specify an IP port number to activate this function. The default is an empty option field, meaning that no ASCII ephemeris output via IP port is generated.
</p>
<p>
The source code for BNC comes with an example perl script 'test_bnc_eph.pl' that allows you to read BNC's ASCII ephemeris output from the IP port.
</p>

<p><a name="ephvers"><h4>3.5.4 Version - optional</h4></p>
<p>
Default format for RINEX Navigation files containing broadcast ephemeris is RINEX Version 2.11. Select 'Version 3' if you want to save the ephemeris in RINEX Version 3 format.
</p>
<p>
Note that this does not concern the broadcast ephemeris output through IP port which is always in RINEX Version 3 format.
</p> 

<p><a name="correct"><h4>3.6. Broadcast Corrections</h4></p>
<p>
</p>
RTCM is in the process of developing new Version 3 messages to transport satellite clock and orbit corrections in real-time. Based on the latest available proposal, the following premature so-called 'State Space Representation' (SSR) messages currently under discussion have been implemented in BNC. The information below should not be misunderstood as a programmers guide. Programming efforts would definitely require access to the RTCM documentation of SSR messages.
<ul>
<li>Message type 1057: GPS orbit corrections to Broadcast Ephemeris</li>
<li>Message type 1058: GPS clock corrections to Broadcast Ephemeris</li>
<li>Message type 1059: GPS code biases</li>
<li>Message type 1060: Combined orbit and clock corrections to GPS Broadcast Ephemeris</li>
<li>Message type 1061: GPS User Range Accuracy (URA)</li>
<li>Message type 1062: High-rate GPS clock corrections to Broadcast Ephemeris</li>
<li>Message type 1063: GLONASS orbit corrections to Broadcast Ephemeris</li>
<li>Message type 1064: GLONASS clock corrections to Broadcast Ephemeris</li>
<li>Message type 1065: GLONASS code biases</li>
<li>Message type 1066: Combined orbit and clock corrections to GLONASS Broadcast Ephemeris</li>
<li>Message type 1067: GLONASS User Range Accuracy (URA)</li>
<li>Message type 1068: High-rate GLONASS clock corrections to Broadcast Ephemeris</li>
</ul>
<p>
RTCM Version 3 streams carrying these messages may be used i.e. to support real-time Precise Point Positioning (PPP) applications. 
</p>
<p>
When using clocks from Broadcast Ephemeris (with or without applied corrections) or clocks from SP3 files, it may be important to understand that they are not corrected for the conventional periodic relativistic effect. Chapter 10 of the IERS Conventions 2003 mentions that the conventional periodic relativistic correction to the satellite clock (to be added to the broadcast clock) is computed as dt =  -2 (R * V) / c^2 where R * V is the scalar product of the satellite position and velocity and c is the speed of light. This can also be found in the GPS Interface Specification, IS-GPS-200, Revision D, 7 March 2006.
</p>

<p>
Orbit corrections are provided in along-track, cross-track and radial components. These components are defined in the Earth-centered, Earth-fixed reference frame of the broadcast ephemerides. For an observer in this frame, the along-track component is aligned in both direction and sign with the velocity vector, the cross-track component is perpendicular to the plane defined by the satellite position and velocity vectors, and the radial direction is perpendicular to the along track and cross-track ones. The three components form a right-handed orthogonal system.
</p>

<p>
After applying corrections, the satellite position and clock is referred to the 'ionospheric free' phase center of the antenna which is compatible with the broadcast orbit reference.
</p>

<p>
The orbit and clock corrections do not include local effects (like Ocean Loading or Solid Earth Tides) or atmospheric effects (Ionosphere and/or troposphere). Depending on the accuracy of your application you should correct for such effects by other means. There is currently no RTCM SSR message for ionospheric state parameters. Such messages are needed for accurate single frequency applications. The development of Iono messages will be the next step in the schedule of the RTCM State Space Representation Working Group.
</p>

<p>
Broadcast Corrections can be saved by BNC in files. The file name convention for Broadcast Correction files follows the convention for RINEX files except for the last character of the file name suffix which is set to &quot;C&quot;.
</p>

<p>
Saved files contain blocks of records in plain ASCII format where - separate for GPS, GLONASS, message types, streams, and epochs - the begin of a block is indicated by a line like (examples):
</p>
<p>
! Orbits/Clocks: 30 GPS 0 Glonass CLK11<br>
or<br>
! Orbits/Clocks: 0 GPS 19 Glonass CLK11
<p>
Such line informs you about the number of records (here 30 and 19) carrying GPS or GLONASS related parameters you should receive next as part of a certain stream. 
</p>
<p>
The first five parameters in each broadcast corrections record are:
</p>
<p>
<ul>
<li>RTCMv3 message type number</li>
<li>SSR message update interval indicator</li>
<ul>
<li>0 = 1 sec</li>
<li>1 = 2 sec</li>
<li>2 = 5 sec</li>
<li>3 = 10 sec</li>
<li>4 = 15 sec</li>
<li>5 = 30 sec</li>
<li>6 = 60 sec</li>
<li>7 = 120 sec</li>
<li>8 = 240 sec</li>
<li>9 = 300 sec</li>
<li>10 = 600 sec</li>
<li>11 = 900 sec</li>
<li>12 = 1800 sec</li>
<li>13 = 3600 sec</li>
<li>14 = 7200 sec</li>
<li>15 = 10800 sec</li>
</ul>
<li>GPS Week</li>
<li>Second in GPS Week</li>
<li>GNSS Indicator and Satellite Vehicle Pseudo Random Number</li>
</ul>
</p>
<p>
In case of RTCM message types 1057 or 1063 these parameters are followed by
</p>
<p>
<ul>
<li>IOD referring to Broadcast Ephemeris set</li>
<li>Radial Component of Orbit Correction to Broadcast Ephemeris [m]</li>
<li>Along-track Component of Orbit Correction to Broadcast Ephemeris [m]</li>
<li>Cross-track Component of Orbit Correction to Broadcast Ephemeris [m]</li>
<li>Velocity of Radial Component of Orbit Correction to Broadcast Ephemeris [m/s]</li>
<li>Velocity of Along-track Component of Orbit Correction to Broadcast Ephemeris [m/s]</li>
<li>Velocity of Cross-track Component of Orbit Correction to Broadcast Ephemeris [m/s]</li>
<p>
</ul>
</p>
<p>
Undefined parameters are set to zero &quot;0.000&quot;.<br>Example:
<pre>
...
1057 0 1538 211151.0 G18     1      0.034    0.011   -0.064      0.000    0.000    0.000
1057 0 1538 211151.0 G16    33     -0.005    0.194   -0.091      0.000    0.000    0.000
1057 0 1538 211151.0 G22    50      0.008   -0.082   -0.001      0.000    0.000    0.000
...
1063 0 1538 211151.0 R09   111     -0.011   -0.014    0.005      0.000    0.000    0.000
1063 0 1538 211151.0 R10    43      0.000   -0.009   -0.002      0.000    0.000    0.000
1063 0 1538 211151.0 R21    75     -0.029    0.108    0.107      0.000    0.000    0.000
...
</pre>
<p>
In case of RTCM message types 1058 or 1064 the first five parameters are followed by
</p>
<ul>
<li>IOD set to zero &quot;0&quot;</li>
<li>C0 polynomial coefficient for Clock Correction to Broadcast Ephemeris [m]</li>
<li>C1 polynomial coefficient for Clock Correction to Broadcast Ephemeris [m/s]</li>
<li>C2 polynomial coefficient for Clock Correction to Broadcast Ephemeris [m/s**2]</li>
</ul>
Example:
</p>
<pre>
...
1058 0 1538 211151.0 G18     0      1.846       0.000    0.000
1058 0 1538 211151.0 G16     0      0.376       0.000    0.000
1058 0 1538 211151.0 G22     0      2.727       0.000    0.000
...
1064 0 1538 211151.0 R08     0      8.956       0.000    0.000
1064 0 1538 211151.0 R07     0     14.457       0.000    0.000
1064 0 1538 211151.0 R23     0      6.436       0.000    0.000
...
</pre>
</p>
<p>
In case of RTCM message types 1060 or 1066 the first five parameters are followed by
<p>
<ul>
<li>IOD referring to Broadcast Ephemeris set</li>
<li>C0 polynomial coefficient for Clock Correction to Broadcast Ephemeris [m]</li>
<li>Radial Component of Orbit Correction to Broadcast Ephemeris [m]</li>
<li>Along-track Component of Orbit Correction to Broadcast Ephemeris [m]</li>
<li>Cross-track Component of Orbit Correction to Broadcast Ephemeris [m]</li>
<li>C1 polynomial coefficient for Clock Correction to Broadcast Ephemeris [m]</li>
<li>Velocity of Radial Component of Orbit Correction to Broadcast Ephemeris [m/s]</li>
<li>Velocity of Along-track Component of Orbit Correction to Broadcast Ephemeris [m/s]</li>
<li>Velocity of Cross-track Component of Orbit Correction to Broadcast Ephemeris [m/s]</li>
<li>C2 polynomial coefficient for Clock Correction to Broadcast Ephemeris [m]</li>
</ul>
Example:
</p>
<pre>
...
1060 0 1538 211610.0 G30    82      2.533      0.635   -0.359   -0.598    0.000    0.000    0.000    0.000    0.000
1060 0 1538 211610.0 G31     5     -4.218     -0.208    0.022    0.002    0.000    0.000    0.000    0.000    0.000
1060 0 1538 211610.0 G32    28     -2.326      0.977   -0.576    0.142    0.000    0.000    0.000    0.000    0.000
...
1066 0 1538 211610.0 R22    27      1.585      2.024    2.615   -2.080    0.000    0.000    0.000    0.000    0.000
1066 0 1538 211610.0 R23    27      6.277      2.853    4.181    1.304    0.000    0.000    0.000    0.000    0.000
1066 0 1538 211610.0 R24    27      0.846      1.805   13.095    6.102    0.000    0.000    0.000    0.000    0.000
...
</pre>
</p>
<p>
In case of RTCM message types 1059 or 1065 the first five parameters are followed by
<ul>
<li>Number of Code Biases</li>
<li>Indicator to specify the signal and tracking mode</li>
<li>Code Bias</li>
<li>Indicator to specify the signal and tracking mode</li>
<li>Code Bias</li>
<li>etc.</li>
</ul>
Example:
</p>
<pre>
...
1059 0 1538 211151.0 G18 2 0   -0.010 11   -0.750 
1059 0 1538 211151.0 G16 2 0   -0.040 11   -0.430
1059 0 1538 211151.0 G22 2 0   -0.630 11   -2.400
...
</pre>

<p><a name="corrdir"><h4>3.6.1 Directory - optional</h4></p>
<p>
Specify a directory for saving Broadcast Corrections in files. If the specified directory does not exist, BNC will not create Broadcast Correction files. Default value for Broadcast Corrections 'Directory' is an empty option field, meaning that no Broadcast Correction files will be created.
</p>

<p><a name="corrint"><h4>3.6.2 Interval - mandatory if 'Directory' is set</h4></p>
<p>
Select the length of the Broadcast Correction files. The default value is 1 day.
</p>

<p><a name="corrport"><h4>3.6.3 Port - optional</h4></p>
<p>
BNC can output epoch by epoch synchronized Broadcast Corrections in ASCII format on your local host (IP 127.0.0.1) through an IP 'Port'. Specify an IP port number to activate this function. The default is an empty option field, meaning that no Broadcast Correction output via IP port is generated.
</p>
<p>
The output format equals the format used for saving Broadcast Corrections in a file with the exception that the Mountpoint is added at each line's end.
</p>
<p>
The following is an example output for streams from Mountpoints RTCMSSR, CLK10 and CLK11:
<pre>
...
1057 0 1538 211151.0 G18     1      0.034    0.011   -0.064    0.000    0.000    0.000 RTCMSSR
1057 0 1538 211151.0 G16    33     -0.005    0.194   -0.091    0.000    0.000    0.000 RTCMSSR
1057 0 1538 211151.0 G22    50      0.008   -0.082   -0.001    0.000    0.000    0.000 RTCMSSR
...
1058 0 1538 211151.0 G18     0      1.846    0.000 RTCMSSR
1058 0 1538 211151.0 G16     0      0.376    0.000 RTCMSSR
1058 0 1538 211151.0 G22     0      2.727    0.000 RTCMSSR
...
1059 0 1538 211151.0 G18 2 0   -0.010 11   -0.750 RTCMSSR
1059 0 1538 211151.0 G16 2 0   -0.040 11   -0.430 RTCMSSR
1059 0 1538 211151.0 G22 2 0   -0.630 11   -2.400 RTCMSSR
...
1063 0 1538 211151.0 R09   111     -0.011   -0.014    0.005    0.0000    0.000    0.000 RTCMSSR
1063 0 1538 211151.0 R10    43      0.000   -0.009   -0.002    0.0000    0.000    0.000 RTCMSSR
1063 0 1538 211151.0 R21    75     -0.029    0.108    0.107    0.0000    0.000    0.000 RTCMSSR
...
1064 0 1538 211151.0 R08     0      8.956    0.000 RTCMSSR
1064 0 1538 211151.0 R07     0     14.457    0.000 RTCMSSR
1064 0 1538 211151.0 R23     0      6.436    0.000 RTCMSSR
...
1066 0 1538 211610.0 R24    27      0.846      1.805   13.095    6.102    0.000    0.000    0.000    0.000    0.000 CLK11
1066 0 1538 211610.0 R23    27      6.277      2.853    4.181    1.304    0.000    0.000    0.000    0.000    0.000 CLK11
1066 0 1538 211610.0 R22    27      1.585      2.024    2.615   -2.080    0.000    0.000    0.000    0.000    0.000 CLK11
...
1060 0 1538 211610.0 G32    28     -2.326      0.977   -0.576    0.142    0.000    0.000    0.000    0.000    0.000 CLK10
1060 0 1538 211610.0 G31     5     -4.218     -0.208    0.022    0.002    0.000    0.000    0.000    0.000    0.000 CLK10
1060 0 1538 211610.0 G30    82      2.533      0.635   -0.359   -0.598    0.000    0.000    0.000    0.000    0.000 CLK10
...
</pre>
</p>
<p>
The source code for BNC comes with an example perl script 'test_bnc_eph.pl' that allows you to read BNC's Broadcast Corrections from the IP port.
</p>

<p><a name="corrwait"><h4>3.6.4 Wait for Full Epoch - mandatory if 'Port' is set</h4></p>
<p>
When feeding a real-time GNSS network engine waiting epoch by epoch for synchronized Broadcast Corrections, BNC drops (only concerning IP port output) whatever is received later than 'Wait for full epoch' seconds. A value of 2 to 5 seconds could be an appropriate choice for that, depending on the latency of the incoming Broadcast Corrections stream and the delay acceptable by your application. A message such as &quot;COCK1: Correction overaged by 5 sec&quot; shows up in BNC's logfile if 'Wait for full epoch' is exceeded.
</p>

<p><a name="syncout"><h4>3.7. Feed Engine</h4></p>
<p>
BNC can generate synchronized or unsynchronized observations epoch by epoch from all stations and satellites to feed a real-time GNSS network engine. The output can be produced in a binary format through an IP port and/or a plain ASCII format to save the observations in a local file. It comprises the following observations where available:</p>
<p>
StatID, SVPRN, GPSWeek, GPSWeeks, C1, C2, P1, P2, L1, L2, slip_cnt_L1, slip_cnt_L2, lock_timei_L1, lock_timei_L2, S1, S2, SNR1, SNR2
</p>
<p>
Note that slip_cnt stands for the cumulative loss of continuity indicator, lock_timei for the lock time indicator, and SNR for the signal-to-noise ratio 'S' mapped to integer numbers 1 to 9. In case an observation is not available, its value is set to zero '0.000'. Loss of continuity indicator and lock time indicator are set to negative values if undefined.
</p>

<p>The binary output is a continuous stream in the following order:</p>
<pre>
begEpoch
t_obsInternal
t_obsInternal
...
t_obsInternal
endEpoch
begEpoch
t_obsInternal
...
</pre>

<p>The corresponding structures are defined as follow:</p>
<pre>
  const char begEpoch[] = &quot;BEGEPOCH&quot;;
  const char endEpoch[] = &quot;ENDEPOCH&quot;;
...
...
class t_obsInternal {
 public:
  int    flags;
  char   StatID[20+1];  // Station ID
  char   satSys;        // Satellite System ('G' for GPS or 'R' for GLONASS or 'S' for Geostationary signal payload)
  int    satNum;        // Satellite Number (PRN for GPS NAVSTAR)
  int    slot;          // Slot Number (for Glonass)
  int    GPSWeek;       // Week of GPS-Time
  double GPSWeeks;      // Second of Week (GPS-Time)
  double C1;            // CA-code pseudorange (meters)
  double C2;            // CA-code pseudorange (meters)
  double P1;            // P1-code pseudorange (meters)
  double P2;            // P2-code pseudorange (meters)
  double L1;            // L1 carrier phase (cycles)
  double L2;            // L2 carrier phase (cycles)
  int    slip_cnt_L1;   // L1 cumulative loss of continuity indicator (negative value = undefined)
  int    slip_cnt_L2;   // L2 cumulative loss of continuity indicator (negative value = undefined)
  int    lock_timei_L1; // L1 last lock time indicator                (negative value = undefined)
  int    lock_timei_L2; // L2 last lock time indicator                (negative value = undefined)
  double S1;            // L1 signal-to noise ratio
  double S2;            // L2 signal-to noise ratio
  int    SNR1;          // L1 signal-to noise ratio (mapped to integer)
  int    SNR2;          // L2 signal-to noise ratio (mapped to integer)
};
</pre>

<p>
The source code for BNC comes with an example program called 'test_bnc_qt.cpp' that allows you to read BNC's (synchronized or unsynchronized) binary observation output from the IP port and print the observations in a plain ASCII format on standard output.
</p>
<p>
Note that any socket connection of an application to BNC's synchronized or unsynchronized observations ports is recorded in the 'Log' tab on the bottom of the main window together with a connection counter, resulting in log records like 'New client connection on sync/usync port: # 1'.
</p>

<p>
The following figure shows the screenshot of a BNC configuration where a number if streams is pulled from different NTRIP broadcasters to feed a GNSS engine via IP port output.
</p>
<p><img src=":bnchelp/screenshot12.png"/></p>
<p><u>Figure:</u> Synchronized BNC output via IP port to feed a GNSS real-time engine.</p>

<p><a name="syncport"><h4>3.7.1 Port - optional</h4></p>
<p>
BNC can produce synchronized observations in binary format on your local host (IP 127.0.0.1) through an IP 'Port'. Synchronized means that BNC collects all data for any specific epoch which become available within a certain number of latency seconds (see 'Wait for Full Epoch' option). It then - epoch by epoch - outputs whatever has been received. Specify an IP port number here to activate this function. The default is an empty option field, meaning that no binary synchronized output is generated.</p>
</p>

<p><a name="syncwait"><h4>3.7.2 Wait for Full Epoch - mandatory if 'Port' is set</h4></p>
<p>
When feeding a real-time GNSS network engine waiting for synchronized input epoch by epoch, BNC drops whatever is received later than 'Wait for full epoch' seconds. A value of 3 to 5 seconds could be an appropriate choice for that, depending on the latency of the incoming streams and the delay acceptable for your real-time GNSS product. Default value for 'Wait for full epoch' is 5 seconds.
</p>
<p>
Note that 'Wait for full epoch' does not effect the RINEX Observation file content. Observations received later than 'Wait for full epoch' seconds will still be included in the RINEX Observation files.
</p> 

<p><a name="syncsample"><h4>3.7.3 Sampling - mandatory if 'File' or 'Port' is set</h4></p>
<p>
Select the synchronized observation output sampling interval in seconds. A value of zero '0' tells BNC to send/store all received epochs. This is the default value.
</p>

<p><a name="syncfile"><h4>3.7.4 File - optional</h4></p>
<p>
Specifies the full path to a 'File' where synchronized observations are saved in plain ASCII format. The default value is an empty option field, meaning that no ASCII output file is created.
</p>
<p>
Beware that the size of this file can rapidly increase depending on the number of incoming streams. This option is primarily meant for testing and evaluation.
</p>

<p><a name="syncuport"><h4>3.7.5 Port (unsynchronized) - optional</h4></p>
<p>
BNC can produce unsynchronized observations from all configured streams in binary format on your local host (IP 127.0.0.1) through an IP 'Port'. Unsynchronized means that BNC immediately forwards any received observation to the port. Specify an IP port number here to activate this function. The default is an empty option field, meaning that no binary unsynchronized output is generated.</p>
<p>

<p><a name="serial"><h4>3.8. Serial Output</h4></p>
<p>
You may use BNC to feed a serial connected device like an GNSS receiver. For that one of the incoming streams can be forwarded to a serial port. The following figure shows the screenshot of an example situation where BNC pulls a VRS stream from an NTRIP broadcaster to feed a serial connected rover. 
</p>
</p>
<p><img src=":bnchelp/screenshot11.png"/></p>
<p><u>Figure:</u> BNC pulling a VRS stream to feed a serial connected rover.</p>

<p><a name="sermount"><h4>3.8.1 Mountpoint - optional</h4></p>
<p>
Enter a 'Mountpoint' to forward its corresponding stream to a serial connected GNSS receiver.
</p>
<p>
When selecting the serial communication options listed below, make sure that you pick those configured to the serial connected receiver.
</p>

<p><a name="serport"><h4>3.8.2 Port Name - mandatory if 'Mountpoint' is set</h4></p>
<p>
Enter the serial 'Port name' selected on your host for communication with the serial connected receiver. Valid port names are
</p>
<pre>
Windows:       COM1, COM2
Linux:         /dev/ttyS0, /dev/ttyS1
FreeBSD:       /dev/ttyd0, /dev/ttyd1
Digital Unix:  /dev/tty01, /dev/tty02
HP-UX:         /dev/tty1p0, /dev/tty2p0
SGI/IRIX:      /dev/ttyf1, /dev/ttyf2
SunOS/Solaris: /dev/ttya, /dev/ttyb
</pre>
<p>
Note that you must plug a serial cable in the port defined here before you start BNC.
</p>

<p><a name="serbaud"><h4>3.8.3 Baud Rate - mandatory if 'Mountpoint' is set</h4></p>
<p>
Select a 'Baud rate' for the serial output link. Note that using a high baud rate is recommended.
</p>

<p><a name="serflow"><h4>3.8.4 Flow Control - mandatory if 'Mountpoint' is set</h4></p>
<p>
Select a 'Flow control' for the serial output link. Note that your selection must equal the flow control configured to the serial connected device. Select 'OFF' if you don't know better.
</p>

<p><a name="serparity"><h4>3.8.5 Parity - mandatory if 'Mountpoint' is set</h4></p>
<p>
Select the 'Parity' for the serial output link. Note that parity is often set to 'NONE'.
</p>

<p><a name="serdata"><h4>3.8.6 Data Bits - mandatory if 'Mountpoint' is set</h4></p>
<p>
Select the number of 'Data bits' for the serial output link. Note that often '8' data bits are used.
</p>

<p><a name="serstop"><h4>3.8.7 Stop Bits - mandatory if 'Mountpoint' is set</h4></p>
<p>
Select the number of 'Stop bits' for the serial output link. Note that often '1' stop bit is used.
</p>

<p><a name="serauto"><h4>3.8.8 NMEA - mandatory for VRS streams</h4></p>
<p>
Select 'Auto' to automatically forward all NMEA-GGA messages coming from your serial connected GNSS receiver to the NTRIP broadcaster and/or save them in a file.
</p>
<p>
Forwarding valid NMEA-GGA messages to the NTRIP broadcaster is required for receiving 'Virtual Reference Station' (VRS) streams. Thus, in case your serial connected receiver is not capable to provide them, the alternative for VRS streams is a 'Manual' simulation of an initial NMEA-GGA message. Its contents is based on the approximate (editable) latitude/longitude from the broadcaster's source-table and an approximate VRS height to be specified.
</p>
<p>
In summary: select 'Manual' only when handling a VRS stream and your serial connected GNSS receiver doesn't generate NMEA-GGA messages. Select 'Auto' otherwise.
</p>

<p><a name="serfile"><h4>3.8.9 File - optional if 'Auto' NMEA is set</h4></p>
<p>Specify the full path to a file where NMEA messages coming from your serial connected receiver are saved.
</p>
<p><a name="serheight"><h4>3.8.10 Height - mandatory if 'Manual' NMEA is set</h4></p>
<p>
Specify an approximate 'Height' above mean sea level in meter for your VRS to simulate an initial NMEA-GGA message. Latitude and longitude for that (editable) are taken from the broadcaster's source-table.
</p>
<p>
This option concerns only 'Virtual Reference Stations' (VRS). Its setting is ignored in case of streams coming from physical reference stations.
</p>

<p><a name="advnote"><h4>3.9. Outages</h4></p>

<p>
At various times, the incoming stream might become unavailable or corrupted. In such cases, it is important that the BNC operator and/or the stream providers become aware of the situation so that necessary measures can be taken to restore the stream. Furthermore, continuous attempts to decode corrupted stream(s) can generate unnecessary workload for BNC. Outages and corruptions are handled by BNC as follows:
</p>
<p>
<u>Stream outages:</u> BNC considers a connection to be broken when there are no incoming data detected for more than 20 seconds. When this occurs, BNC will attempt to reconnect at a decreasing rate. It will first try to reconnect with 1 second delay, and again in 2 seconds if the previous attempt failed. If the attempt is still unsuccessful, it will try to reconnect within 4 seconds after the previous attempt and so on. The wait time doubles each time with a maximum wait time of 256 seconds.
</p>
<p>
<u>Stream corruption:</u> Not all bits chunk transfers to BNC's internal decoders return valid observations. Sometimes several chunks might be needed before the next observation can be properly decoded. BNC buffers all the outputs (both valid and invalid) from the decoder for a short time span (size derived from the expected 'Observation rate') and then determines whether a stream is valid or corrupted.
</p>
<p>
Outage and corruption events are reported in the 'Log' tab. They can also be passed on as parameters to a shell script or batch file to generate an advisory note to BNC operator or affected stream providers. This functionality lets users utilize BNC as a real-time performance monitor and alarm system for a network of GNSS reference stations.
</p>

<p><a name="obsrate"><h4>3.9.1 Observation Rate - mandatory if 'Failure threshold', 'Recovery threshold', and 'Script' is set</h4></p>
<p>
BNC can collect all returns (success or failure) coming from a decoder within a certain short time span to then decide whether a stream has an outage or its content is corrupted. This procedure needs a rough a priory estimate of the expected observation rate of the incoming streams.</p><p>An empty option field (default) means that you don't want an explicit information from BNC about stream outages and incoming streams that cannot be decoded.
</p> 

<p><a name="advfail"><h4>3.9.2 Failure Threshold - optional</h4></p>
<p>
Event 'Begin_Failure' will be reported if no data is received continuously for longer than the 'Failure threshold' time. Similarly, event 'Begin_Corrupted' will be reported when corrupted data is detected by the decoder continuously for longer than this 'Failure threshold' time. The default value is set to 15 minutes and is recommended so not to innundate user with too many event reports.
</p>
<p>
Note that specifying a value of zero '0' for the 'Failure threshold' will force BNC to report any stream failure immediately. Note also that for using this function you need to specify the 'Observation rate'.
</p>

<p><a name="advreco"><h4>3.9.3 Recovery Threshold - optional</h4></p>
<p>
Once a 'Begin_Failure' or 'Begin_Corrupted' event has been reported, BNC will check for when the stream again becomes available or uncorrupted. Event 'End_Failure' or 'End_Corrupted' will be reported as soon as valid observations are again detected continuously throughout the 'Recovery threshold' time span. The default value is set to 5 minutes and is recommended so not to innundate users with too many event reports.  
</p>
<p>
Note that specifying a value of zero '0' for the 'Recovery threshold' will force BNC to report any stream recovery immediately. Note also that for using this function you need to specify the 'Observation rate'.
</p>

<p><a name="advscript"><h4>3.9.4 Script - optional </h4></p>
<p>
As mentioned previously, BNC can trigger a shell script or a batch file to be executed when one of the events described are reported. This script can be used to email an advisory note to network operator or stream providers. To enable this feature, specify the full path to the script or batch file in the 'Script' field. The affected stream's mountpoint and type of event reported ('Begin_Outage', 'End_Outage', 'Begin_Corrupted' or 'End_Corrupted') will then be passed on to the script as command line parameters (%1 and %2 on Windows systems or $1 and $2 on Unix/Linux/Mac systems) together with date and time information.
</p>
<p>
Leave the 'Script' field empty if you do not wish to use this option. An invalid path will also disable this option.
</p> 
<p>
Examples for command line parameter strings passed on to the advisory 'Script' are:
<pre>
FFMJ0 Begin_Outage 08-02-21 09:25:59
FFMJ0 End_Outage 08-02-21 11:36:02 Begin was 08-02-21 09:25:59
</pre>
Sample script for Unix/Linux/Mac systems:
<pre>
#!/bin/bash
sleep $((60*RANDOM/32767))
cat | mail -s &quot;NABU: $1&quot; email@address &lt;&lt;!
Advisory Note to BNC User,
Please note the following advisory received from BNC.
Stream: $*
Regards, BNC
!
</pre>
</p> 
<p> 
Note the sleep command in this script which causes the system to wait for a random period of up to 60 seconds before sending the email. This should avoids overloading your mail server in case of a simultaneous failure of many streams.
</p> 

<p><a name="misc"><h4>3.10. Miscellaneous</h4></p>
<p>
This section describes a number of miscellaneous options which can be applied for a single stream (mountpoint) or for all configured streams.
</p>

<p>
The following figure shows RTCM message numbers contained in stream 'CONZ0' and the message latencies recorded every 10 seconds.
</p>
<p><img src=":bnchelp/screenshot14.png"/></p>
<p><u>Figure:</u> RTCM message numbers and latencies.</p>


<p><a name="miscmount"><h4>3.10.1 Mountpoint - optional </h4></p>
<p>
Specify a mountpoint to apply one or several of the 'Miscellaneous' options to the corresponding stream. Enter 'ALL' if you want to apply these options to all configured streams. An empty option field (default) means that you don't want BNC to apply any of these options.
</p>

<p><a name="miscperf"><h4>3.10.2 Log Latency - optional </h4></p>
<p>
 BNC can average latencies per stream over a certain period of GPS time, the 'Log latency' interval. Mean latencies are calculated from the individual latencies of at most one (first incoming) observation or correction to Broadcast Ephemeris per second. The mean latencies are then saved in BNC's logfile. Note that computing correct latencies requires the clock of the host computer to be properly synchronized. Note further that the latencies available from the 'Latency' tab on the bottom of the main window represent individual latencies and not the mean latencies for the logfile.
</p>
<p>
<u>Latency:</u> Latency is defined in BNC by the following equation:
</p>
<pre>
    UTC time provided by BNC's host
  - GPS time of currently processed epoch
  + Leap seconds between UTC and GPS time
  --------------
  = Latency
</pre>
<p>
<u>Statistics:</u> BNC counts the number of GPS seconds covered by at least one observation. It also estimates an observation rate (independent from the a priory specified 'Observation rate') from all observations received throughout the first full 'Log latency' interval. Based on this rate, BNC estimates the number of data gaps when appearing in subsequent intervals. 
</p>
<p>
Latencies of observations or corrections to Broadcast Ephemeris and statistical information can be recorded in the 'Log' tab at the end of each 'Log latency' interval. A typical output from a 1 hour 'Log latency' interval would be:
</p>
<pre>
08-03-17 15:59:47 BRUS0: Mean latency 1.47 sec, min 0.66, max 3.02, rms 0.35, 3585 epochs, 15 gaps
</pre>
<p>
Select a 'Log latency' interval to activate this function or select the empty option field if you do not want BNC to log latencies and statistical information.
</p>


<p><a name="miscscan"><h4>3.10.3 Scan RTCM - optional</h4></p>
<p>
When configuring a GNSS receiver for RTCM stream generation, the setup interface may not provide details about RTCM message types. As reliable information concerning stream contents should be available i.e. for NTRIP broadcaster operators to maintain the broadcaster's source-table, BNC allows to scan RTCM streams for incoming message types and printout some of the contained meta-data. The idea for this option arose from 'InspectRTCM', a comprehensive stream analyzing tool written by D. Stoecker.
</p>
<p>
Tick 'Scan RTCM' to scan RTCM Version 2.x or 3.x streams and log all contained
</p>
<ul>
<li>numbers of incoming message types</li>
<li>Antenna Reference Point (ARP) coordinates</li>
<li>Antenna Phase Center (APC) coordinates</li>
<li>antenna height above marker</li>
<li>antenna descriptor.</li>
</ul>
</p>

<p>
Note that in RTCM Version 2.x the message types 18 and 19 carry only the observables of one frequency. Hence it needs two type 18 and 19 messages per epoch to transport the observations from dual frequency receivers.
</p>
<p>

<p>Logged time stamps refer to message reception time and allow to understand repetition rates. Enter 'ALL' if you want to log this information from all configured streams. Beware that the size of the logfile can rapidly increase depending on the number of incoming RTCM streams. 
</p>
<p>This option is primarily meant for testing and evaluation. Use it to figure out what exactly is produced by a specific GNSS receiver's configuration. An empty option field (default) means that you don't want BNC to print the message type numbers and antenna information carried in RTCM streams. 
</p>

<p><a name="pppclient"><h4>3.11. PPP Client</h4></p>
<p>
BNC can derive coordinates for a rover position following the Precise Point Positioning (PPP) approach. It uses either code or code plus phase data in ionosphere free linear combinations P3 or L3. Besides pulling a stream of observations from a dual frequency receiver, this also requires pulling in addition
<ul>
<li>a stream carrying satellite orbit and clock corrections to Broadcast Ephemeris in the form of 'State Space Representation' (SSR) messages as proposed by RTCM (i.e. premature message type 1060). Note that for BNC these correctors need to be referred to the satellite's Antenna Phase Center (APC). Streams providing such messages are listed on <u>http://igs.bkg.bund.de/ntrip/orbits</u>. Stream products.igs-ip.net:2101/CLK11 is an example.</li>
<li>a stream carrying Broadcast Ephemeris available as RTCM Version 3 message types 1019 and 1020. This is a must only when the stream coming from the receiver does not contain Broadcast Ephemeris or provides them only at very low repetition rate. Streams providing such messages are listed on <u>http://igs.bkg.bund.de/ntrip/ephemeris</u>. Stream products.igs-ip.net:2101/RTCM3EPH is an example.</li>
</ul>
</p>
<p>
The following figure provides the screenshot of an example PPP session with BNC.
</p>
<p><img src=":bnchelp/screenshot03.png"/></p>
<p><u>Figure:</u> Precise Point Positioning (PPP) with BNC.</p>

<p>
PPP results are shown in the 'Log' tab on the bottom of BNC's main window. Depending on the processing options, the following values are shown about once per second (example):
<pre>
10-09-08 09:14:06 FFMJ1  PPP 09:14:04.0 12    4053457.429 +-  2.323     617730.551 +-  1.630    4869395.266 +-  2.951
</pre>
</p>
<p>
The 'PPP' string in that is followed by the selected mounpoint, a PPP time stamp in GPS Time, the number of processed satellites, and XYZ coordinates with their formal errors as derived from the implemented filter in [m]. The implemented algorithm includes an outlier and cycle slip detection. The maximum for accepted residuals is hard coded to 10 meters for code observations and 10 centimeters for phase observations.
</p>

<p>
More detailed PPP results are saved in BNC's logfile. Depending on the selected processing options you find
<ul>
<li>code and phase residuals for GPS and GLONASS in [m], </li>
<li>receiver clock errors in [m], </li>
<li>a-priori and correction values of tropospheric zenith delay in [m], 
<li>L3 biases, also known as 'floated ambiguities', given per satellite.
</ul>
These parameters are saved together with their standard deviation. Example extract from a log file:
<pre>
10-08-09 06:04:11 Single Point Positioning of Epoch 06:04:09.0
--------------------------------------------------------------
residuals code     0.386    0.175   -0.378    0.032   -0.103   -2.409   -0.488   -0.576
residuals phase   -0.007   -0.001    0.002    0.002   -0.007   -0.005    0.006    0.007
residuals glo      0.015   -0.004    0.006

    clk     = 68260.392 +-  1.353
    trp     =   2.331 -0.006 +-  0.100
    amb G02 = -0.974 +-  0.809
    amb G10 =  3.250 +-  0.720
    amb G26 = -5.192 +-  0.911
    amb G28 = -0.741 +-  0.909
    amb G08 =  1.317 +-  0.719
    amb G05 = -1.928 +-  0.742
    amb G07 =  4.887 +-  0.853
    amb G13 = -1.190 +-  1.221
    amb R07 = -145.700 +-  0.717
    amb R08 = -140.476 +-  0.939
    amb R10 = -128.820 +-  0.710

</pre>
</p>

<p>
Note that BNC's 'PPP Client' option can also be used in 'Offline Mode'. Apply the 'Offline Mode' command line options for that to read a file containing synchronized observations, orbit and clock corretors, and broadcast ephemeris. Such a file can be generated using BNC's 'Raw output file' option. The first five characters of the file name read in 'Offline Mode' must then be the same as the specified PPP 'Mounpoint': If you produce a 'Raw output file' named 'FFMJ1' then the PPP 'Mountpoint' needs to be also specified as 'FFMJ1' and the command line to execute BNC on a Windows system in 'Offline Mode' could look like:
</p>

<p>
bnc.exe --conf c:\temp\BNC.ppp --file c:\temp\FFMJ1 --format RTCM_3
</p>

<p>
Streams in a 'Raw output file' which shall later be used in an offline PPP calculation must all be encoded in the same format.
</p>

<p>When using the PPP option, it is important to understand which effects are corrected by BNC.
</p>
<ul>
<li>BNC does correct for Solid Earth Tides and Phase Windup.</li>
<li>Satellite Antenna Offsets are not corrected because applied orbit/clock correctors are referred to the satellite's antenna phase center.</li>
<li>Satellite Antenna Offset Variations are neglected because this is a small effect usually less than 2 centimeters.</li>
<li>Receiver Antenna Offsets are not corrected which means that the estimated position is that of the receiver's antenna phase center and not that of the receiver's Antenna Reference Point.</li>
<li>Receiver Antenna Phase Center Variations are not included in the model. The bias caused by this neglect depends on the receiver antenna type. For most antennas it is smaller than a few centimeters.</li>
<li>Ocean and atmospheric loading is neglected. Atmospheric loading is pretty small. Ocean loading is usually also a small effect but may reach up to about 10 centimeters for coastal stations.</li>
<li>Rotational deformation due to polar motion (Polar Tides) is not corrected because this is a small effect usually less than 2 centimeters.</li>
</ul>
</p>

<p><a name="pppmount"><h4>3.11.1 Mountpoint - optional</h4></p>
<p>
Specify a mountpoint if you want BNC to derive coordinates for the affected rover position through a Point Positioning solution. 
</p>
<p>
Furthermore, specify the Point Positioning method you want to apply. Options are 
<ul>
<li> Precise Point Positioning (PPP, default), and </li>
<li> Single Point Positioning (SPP).</li>
</ul>
Note that a plain SPP solution does not require to pull a stream carrying Broadcast Ephemeris Corrections. It only needs Broadcast Ephemeris.
</p>

<p><a name="pppopt"><h4>3.11.2 Options</h4></p>
BNC allows to use different Point Positioning processing options depending on the capability of the involved receiver and the application in mind.
</p>

<p><a name="pppstatic"><h4>3.11.2.1 Static - optional</h4></p>
<p>
By default BNC considers the rover as mobile. It means that the rover coordinates are estimated as stochastic parameters with white noise 100 meters per epoch. Tick 'Static' in a static observation situation to adapt appropriate filter characteristics for that.
</p>

<p><a name="pppphase"><h4>3.11.2.2 Use Phase Obs - optional</h4></p>
<p>
By default BNC applies a Point Positioning solution using an ionosphere free P3 linear combination of code observations. Tick 'Use phase obs' for an ionosphere free L3 linear combination of phase observations.
</p>

<p><a name="ppptropo"><h4>3.11.2.3 Estimate Tropo - optional</h4></p>
<p>
BNC estimates the tropospheric delay according to equation
<pre>
T(z) = T_apr(z) + dT / cos(z)
</pre>
where T_apr is the a-priori tropospheric delay derived from Saastamoinen model.
</p>
<p>
By default BNC does not estimate troposphere parameters. Tick 'Estimate tropo' to estimate troposphere parameters together with the coordinates and save T_apr and dT in BNC's log file.
</p>

<p><a name="pppglo"><h4>3.11.2.4 Use GLONASS - optional</h4></p>
<p>
By default BNC does not process GLONASS observations when in Point Positioning mode. Tick 'Use GLONASS' to use GPS and GLONASS observations for estimating coordinates in Point Positioning mode.
</p>

<p><a name="pppoptcont"><h4>3.11.3 Options cont'd</h4></p>
<p>
You may like to introduce a specific ratio between the sigmas for code and phase observations. You may also like to output average position values.
</p>

<p><a name="pppsigma"><h4>3.11.3.1 Sigma Code - mandatory if 'Use Phase Obs' is set</h4></p>
<p>
When 'Use phase obs' is set in BNC the PPP solution will be carried out using both, code and phase observations. A sigma of 5.0 m for code observations and a sigma of 0.02 m for phase observations (defauls) is used to combine both types of observations. 
As the convergence characteristic of a PPP solution can be influenced by the ratio of the sigmas for code and phase, you may like to introduce you own sigma for code observations which differs from the default of 5.0 m.
<ul>
<li>Introducing a smaller sigma (higher accuracy) for code observations leads to better results shortly after program start. However, it may take more time till you finally get the best possible solutions.</li>
<li>Introducing a higher sigma (lower accuracy) for code observations may lead to less accurate results shortly after program start and thus a prolonged period of convergence but could provide better positions in the long run.</li>
</ul>
</p>
<p>
Note that the 'Sigma code' you enter must be greater than 0.3 m and less than 50.0 m.
</p>

<p><a name="pppaverage"><h4>3.11.3.2 Averaging - optional if appropriate 'Origin' option is set</h4></p>
<p>
Enter the length of a sliding time window in minutes. BNC will continuously output moving average positions and their RMS as computed from those individual positions obtained most recently throughout this period. RMS values presented for XYZ coordinates are bias reduced while RMS values for Nort/East/Up (NEU) displacements are not. Averaged values for XYZ coordinates and their RMS are marked with string &quot;AVE-XYZ&quot; in BNC's log file and 'Log' section while averaged values for NEU displacements and their RMS are marked with string &quot;AVE-NEU&quot;. Example:
</p>
<pre>
10-09-08 09:13:05 FFMJ1  AVE-XYZ 09:13:04.0   4053455.948 +-  0.284     617730.422 +-  0.504    4869397.692 +-  0.089
10-09-08 09:13:05 FFMJ1  AVE-NEU 09:13:04.0    1.043 +-  0.179    0.640 +-  0.456    1.624 +-  0.331
</pre>
<p>
Entering any positive value up to 1440 (24h mean value) is allowed. An empty option field (default) means that you don't want BNC to output moving average positions into the log file and the 'Log' section. Note that averaging positions makes only sense for a stationary receiver.
</p>

<p><a name="ppporigin"><h4>3.11.4 Origin - optional</h4></p>
<p>
Select an origin
</p>
<ul>
<li>for a North/East/Up displacements time series plot in the 'PPP Plot' section, or</li>
<li>for operating BNC in QuickStart mode starting at a known XYZ position.
</ul>
</p>
<p>
QuickStart means that BNC operates for the period of 2 minutes in a mode where an introduced reference coordinate is constrained. The PPP solution is expected to converge within this time span. You may need to create your own reference coordinate through running BNC for an hour in normal mode before applying the QuickStart option. The following options are available:
<ul>
<li>Option 'None' means that BNC shall neither plot a time series of displacements nor start in QuickStart mode.</li>
<li>'Plot - Start position' will let run BNC in normal mode for a stationary receiver and plot a time series referred to the very first determined set of coordinate components.</li>
<li>'Plot - X Y Z' will let run BNC in normal mode for a stationary receiver and plot a time series referred to entered coordinate components XYZ.</li>
<li>Select 'QuickStart - Static' to run BNC in QuickStart mode with observations from a stationary receiver located at known position XYZ.</li>
<li>'QuickStart - Mobile' also allows running BNC in QuickStart mode. However, the receiver may leave its known initial XYZ start position after staying there for two minutes.</li>
</ul>
Default selection for 'Origin' is 'None'. Note that displacements time series plots make only sense for a stationary receiver.
</p>

<p>
</p>
<p><img src=":bnchelp/screenshot17.png"/></p>
<p><u>Figure:</u> BNC in 'QuickStart - Static' mode</p>

<p>
If option 'Plot - X Y Z' or 'QuickStart - Static' is selected, the 'PPP' line in BNC's logfile is extended to  (example):
</p>
<pre>
10-08-09 06:01:56 FFMJ1  PPP 06:02:09.0 11    4053457.628 +-  2.639     617729.438 +-  1.180    4869396.447 +-  1.921  NEU   -0.908   -0.571    1.629
</pre>
<p>
The parameters following the 'NEU' string provide Nort, East and Up components of the current coordinate displacement in meters.
</p>

<p><a name="pppnmeaout"><h4>3.11.5 NMEA</h4></p>
<p>
BNC allows to output results from Precise Point Positioning in NMEA format. The NMEA sentences generated about once per second are pairs of 
<ul>
<li> GPGGA sentences which mainly carry the estimated latitude, longitude, and height values, plus</li>
<li> GPRMC sentences which mainly carry date and time information.</li>
</ul>
</p>
<p>
Note that Tomoji Takasu has written a Windows program called RTKPlot for visualizing NMEA strings. It is available from <u>http://gpspp.sakura.ne.jp/rtklib/rtklib.htm</u> and compatible with the NMEA output of BNC's PPP option.
</p>


<p><a name="pppnmeafile"><h4>3.11.5.1 File - optional</h4></p>
<p>
Specify the full path to a file where Point Positioning results are saved as NMEA messages. The generated NMEA file begins with a single GPRMC message which carries only date and time information. The default value for 'File (full path)' is an empty option field, meaning that BNC will not saved NMEA messages into a file.
</p>

<p><a name="pppnmeaport"><h4>3.11.5.2 Port - optional</h4></p>
<p>
Specify the IP port number of a local port where Point Positioning results become available as NMEA messages. The default value for 'Port' is an empty option field, meaning that BNC does not provide NMEA messages vi IP port. Note that the NMEA file output and the NMEA IP port output are the same. 
</p>

<p><a name="streams"><h4>3.12. Streams</h4></p>
<p>
Each stream on an NTRIP broadcaster (and consequently on BNC) is defined using a unique source ID called mountpoint. An NTRIP client like BNC access the desired data stream by referring to its mountpoint. Information about streams and their mountpoints is available through the source-table maintained by the NTRIP broadcaster. Note that mountpoints could show up in BNC more than once when retrieving streams from several NTRIP broadcasters.
</p>

<p>
Streams selected for retrieval are listed under the 'Streams' canvas section on BNC's main window. The list provides the following information either extracted from source-table(s) produced by the NTRIP broadcasters or introduced by BNC's user:
</p>
<p>
<table>
<tr><td>'resource loader'&nbsp; </td><td>NTRIP broadcaster URL and port, or<br>TCP/IP host and port, or<br>UDP port, or<br>Serial input port specification.</td></tr>
<tr><td>'mountpoint' &nbsp;</td><td>Mountpoint introduced by NTRIP broadcaster, or<br>Mountpoint introduced by BNC's user.</td></tr>
<tr><td>'decoder' &nbsp;</td><td>Type of decoder used to handle the incoming stream content according to its format; editable.</td></tr>
<tr><td>'lat' &nbsp;</td><td>Approximate latitude of reference station, in degrees, north; editable if 'nmea' = 'yes'.</td></tr>
<tr><td>'long' &nbsp;</td><td>Approximate longitude of reference station, in degrees, east; editable if 'nmea' = 'yes'.</td></tr>
<tr><td>'nmea' &nbsp;</td><td>Indicates whether or not streaming needs to be initiated by BNC through sending NMEA-GGA message carrying position coordinates in 'lat' and 'long'.</td></tr>
<tr><td>'ntrip' &nbsp;</td><td>Selected NTRIP transport protocol version (1, 2, R, or U), or<br>'N' for TCP/IP streams without NTRIP, or<br>'UN' for UDP streams without NTRIP, or<br>'S' for serial input streams without NTRIP.</td></tr>
<tr><td>'bytes' &nbsp;</td><td>Number of bytes received.
</table>
</p>

<p><a name="streamedit"><h4>3.12.1 Edit Streams</h4></p>
<ul>
<li>
BNC automatically allocates one of its internal decoders to a stream based on the stream's 'format' and 'format-details' as given in the source-table. However, there might be cases where you need to override the automatic selection due to incorrect source-table for example. BNC allows users to manually select the required decoder by editing the decoder string. Double click on the 'decoder' field, enter your preferred decoder and then hit Enter. The accepted decoder strings are 'RTCM_2.x', 'RTCM_3.x', and 'RTIGS'.
</li>
<li>
In case you need to log the raw data as is, BNC allows users to by-pass its decoders and directly save the input in daily log files. To do this specify the decoder string as 'ZERO'. The generated file names are created from the characters of the streams mountpoints plus two-digit numbers each for year, month, and day. Example: Setting the 'decoder' string for mountpoint WTZZ0 to 'ZERO' and running BNC on March 29, 2007 would save the raw data in a file named WTZZ0_070329.
</li>
<li>
BNC can also retrieve streams from virtual reference stations (VRS). To initiate these streams, an approximate rover position needs to be sent in NMEA format to the NTRIP broadcaster. In return, a user-specific data stream is generated, typically by a Network-RTK software. VRS streams are indicated by a 'yes' in the source-table as well as in the 'nmea' column on the 'Streams' canvas in BNC's main window. They are customized exactly to the latitude and longitude transmitted to the NTRIP broadcaster via NMEA-GGA messages.
<br>If NMEA-GGA messages are not coming from a serial connected GNSS rover, BNC simulates them from the default latitude and longitude of the source-table as shown in the 'lat' and 'long' columns on the 'Streams' canvas. However, in most cases you would probably want to change these defaults according to your requirement. Double-click on 'lat' and 'long' fields, enter the values you wish to send and then hit Enter. The format is in positive north latitude degrees (e.g. for northern hemisphere: 52.436, for southern hemisphere: -24.567) and eastern longitude degrees (example: 358.872 or -1.128). Only streams with a 'yes' in their 'nmea' column can be edited. The position must preferably be a point within the VRS service area of the network. RINEX files generated from these streams will contain an additional COMMENT line in the header beginning with 'NMEA' showing the 'lat' and 'long' used.
<br>Note that when running BNC in a Local Area Network (LAN), NMEA strings may be blocked by a proxy server, firewall or virus scanner.
</li>
</ul> 

<p><a name="streamdelete"><h4>3.12.2 Delete Stream</h4></p>
<p>
To remove a stream from the 'Streams' canvas in the main window, highlight it by clicking on it and hit the 'Delete Stream' button. You can also remove multiple streams simultaneously by highlighting them using +Shift and +Ctrl.</p>

<p><a name="streamconf"><h4>3.12.3 Reconfigure Streams On-the-fly</h4></p>
<p>
The streams selection can be changed on-the-fly without interrupting uninvolved threads in the running BNC process.
</p>
<p>
<u>Window mode:</u> Hit 'Save &amp; Reread Configuration' while BNC is in window mode and already processing data to let changes of your streams selection immediately become effective.
<p>
<u>No window mode:</u> When operating BNC online in 'no window' mode (command line option -nw), you force BNC to reread its 'mountPoints' configuration option from disk at pre-defined intervals. Select '1 min', '1 hour', or '1 day' as 'Reread configuration' option to reread the 'mountPoints' option every full minute, hour, or day. This lets a 'mountPoints' option edited in between in the configuration file become effective without terminating uninvolved threads. See annexed section 'Configuration Example' for a configuration file example and a list of other on-the-fly changeable options.
</p>

<p><a name="logs"><h4>3.13. Logging</h4></p>
<p>
A tabs section on the bottom of the main window provides online control of BNC's activities. Tabs are available to show the records saved in a logfile, for a plot to control the bandwidth consumtion, for a plot showing stream latencies, and for time series plots of PPP results.
</p>
<p><a name="logfile"><h4>3.13.1 Log</h4></p>
<p>
Records of BNC's activities are shown in the 'Log' tab. They can be saved into a file when a valid path is specified in the 'Logfile (full path)' field.
</p>

<p><a name="throughput"><h4>3.13.2 Throughput</h4></p>
<p>
The bandwidth consumption per stream is shown in the 'Throughput' tab in bits per second (bps) or kilo bits per second (kbps). The following figure shows the bandwidth comsumption of incoming streams.
</p>

<p>
</p>
<p><img src=":bnchelp/screenshot08.png"/></p>
<p><u>Figure:</u> Bandwidth consumption of incoming streams.</p>

<p><a name="latency"><h4>3.13.3 Latency</h4></p>
<p>
The latency of observations in each incoming stream is shown in the 'Latency' tab in milliseconds or seconds. Streams not carrying observations (i.e. those providing only broadcast ephemeris messages) or having an outage are not considered here and shown in red color. Note that the calculation of correct latencies requires the clock of the host computer to be properly synchronized. The next figure shows the latency of incoming streams.
</p>

<p>
</p>
<p><img src=":bnchelp/screenshot07.png"/></p>
<p><u>Figure:</u> Latency of incoming streams.</p>

<p><a name="ppptab"><h4>3.13.4 PPP Plot</h4></p>
<p>
Precise Point Positioning time series of North (red), East (green) and Up (blue) coordinate components are shown in the 'PPP Plot' tab when a 'Origin' option is defined. Values are either referred to reference coordinates (if specified) or referred to the first estimated set of coordinate components. The time as given in format [hh:mm] refers to GPS Time. The sliding PPP time series window covers a period of 5 minutes. Note that it may take up to 30 seconds or more till the first PPP solutions becomes available. The following figure shows the screenshot of a PPP time series plot of North, East and Up coordiate components.
</p>

<p>
</p>
<p><img src=":bnchelp/screenshot13.png"/></p>
<p><u>Figure:</u> Time series plot of PPP session.</p>

<p><a name="bottom"><h4>3.14. Bottom Menu Bar</h4></p>
<p>
The bottom menu bar allows to add or delete streams to BNC's configuration and to start or stop it. It also provides access to BNC's online help function. The 'Add Stream' button opens a window that allows user to select one of several input communication links, see figure below.
</p>

<p><img src=":bnchelp/screenshot06.png"/></p>
<p><u>Figure:</u> Steam input communication links.</p>

<p><a name="streamadd"><h4>3.14.1 Add Stream - Coming from Caster</h4></p>

<p>
Button 'Add Stream' &gt; 'Coming from Caster' then opens a window that allows user to select data streams from an NTRIP broadcaster according to their mountpoints.
</p> 

<p><a name="streamhost"><h4>3.14.1.1 Caster Host and Port - mandatory</h4></p>
<p>
Enter the NTRIP broadcaster host IP and port number. Note that EUREF and IGS operate NTRIP broadcasters at <u>http://www.euref-ip.net/home</u> and <u>http://www.igs-ip.net/home</u> and <u>http://www.products.igs-ip.net/home</u>.
</p> 

<p><a name="streamtable"><h4>3.14.1.2 Casters Table - optional</h4></p>
<p>
It may be that your are not sure about your NTRIP broadcasters host and port number or you are interested in other broadcaster installations operated elsewhere. Hit 'Show' for a table of known broadcasters maintained at <u>www.rtcm-ntrip.org/home</u>. A window opens which allows to select a broadcaster for stream retrieval, see figure below.
</p> 
</p>
<p><img src=":bnchelp/screenshot04.png"/></p>

<p><u>Figure:</u> Casters table.</p>

<p><a name="streamuser"><h4>3.14.1.3 User and Password - mandatory for protected streams</h4></p>
<p>
Some streams on NTRIP broadcasters may be restricted. Enter a valid 'User' ID and 'Password' for access to protected streams. Accounts are usually provided per NTRIP broadcaster through a registration procedure. Register through <u>http://igs.bkg.bund.de/ntrip/registeruser</u> for access to protected streams on <u>www.euref-ip.net</u> or <u>www.igs-ip.net</u> or <u>products.igs-ip.net</u>.
</p> 

<p><a name="gettable"><h4>3.14.1.4 Get Table</h4></p>
<p>
Use the 'Get Table' button to download the source-table from the NTRIP broadcaster. Pay attention to data fields 'format' and 'format-details'. Keep in mind that BNC can only decode and convert streams that come in RTCM Version 2.x, RTCM Version 3.x, or RTIGS format. RTCM Version 2.x streams must contain message types 18 and 19 or 20 and 21 while RTCM Version 3.x streams must contain GPS or SBAS message types 1002 or 1004 and may contain GLONASS message types 1010 or 1012, see data field 'format-details' for available message types and their repetition rates in brackets. Note that in order to produce RINEX Navigation files RTCM Version 3.x streams containing message types 1019 (GPS) and 1020 (GLONASS) are required. Select your streams line by line, use +Shift and +Ctrl when necessary. The figure below provides an example source-table.
</p> 
<p>
The contents of data field 'nmea' tells you whether a stream retrieval needs to be initiated by BNC through sending an NMEA-GGA message carrying approximate position coordinates (virtual reference station).
</p>
<p>
Hit 'OK' to return to the main window. If you wish you can click on 'Add Stream' and repeat the process again to retrieve streams from different casters.
</p> 
</p> 
</p>
<p><img src=":bnchelp/screenshot05.png"/></p>
<p><u>Figure:</u> Broadcaster source-table.</p>

<p><a name="ntripv"><h4>3.14.1.5 NTRIP Version - mandatory</h4></p>
<p>
Some limitations and deficiencies of the NTRIP version 1 stream transport protocol are solved in NTRIP version 2. Improvements mainly concern a full HTTP compatibility in view of requirements coming from proxy servers. Version 2 is backwards compatible to Version 1. Options implemented in BNC are:
</p>
<p>
&nbsp; 1:&nbsp; NTRIP version 1, TCP/IP.<br>
&nbsp; 2:&nbsp; NTRIP version 2 in TCP/IP mode.<br>
&nbsp; R:&nbsp; NTRIP version 2 in RTSP/RTP mode.<br>
&nbsp; U:&nbsp; NTRIP version 2 in UDP mode.
</p>
<p>
If NTRIP version 2 is supported by the broadcaster:
</p>
<ul>
<li>Try using option '2' if your streams are otherwise blocked by a proxy server operated in front of BNC.</li>
<li>Option 'R' or 'U' may be selected if latency is more important than completeness for your application. Note that the latency reduction is likely to be in the order of 0.5 sec or less. Note further that options 'R' (RTSP/RTP mode) and 'U' (UDP mode) are not accepted by proxy servers and a mobile Internet Service Provider may not support it.</li>
</ul>
<p>
Select option '1' if you are not sure whether the broadcaster supports NTRIP version 2.</li>
</p>

<p><a name="streamip"><h4>3.14.2 Add Stream - Coming from TCP/IP Port</h4></p>
<p>
Button 'Add Stream' &gt; 'Coming from TCP/IP Port' allows to retrieve streams via TCP directly from an IP address without using the NTRIP transport protocol. For that you:
<ul>
<li>Enter the IP address of the stream providing host.</li>
<li>Enter the IP port number of the stream providing host.</li>
<li>Specify a mountpoint. Recommended is a 4-character station ID. Example: FFMJ</li>
<li>Specify the stream format. Available options are 'RTCM_2', 'RTCM_3', 'RTIGS', and 'ZERO'.</li>
<li>Enter the approximate latitude of the stream providing rover in degrees. Example: 45.32.</li>
<li>Enter the approximate longitude of the stream providing rover in degrees. Example: -15.20.</li>
</ul>
</p>
<p>
Streams directly received from a TCP/IP port show up with an 'N' for 'No NTRIP' in the 'Streams' canvas section on BNC's main window . Latitude and longitude are to be entered just for informal reasons.
<p>
</p>
Note that this option works only if no proxy server is involved in the communication link.
</p>

<p><a name="streamudp"><h4>3.14.3 Add Stream - Coming from UDP Port</h4></p>
<p>
Button 'Add Stream' &gt; 'Coming from UDP Port' allows to pick up streams arriving directly at one of the local host's UDP ports without using the NTRIP transport protocol. For that you:
<ul>
<li>Enter the local port number where the UDP stream arrives.</li>
<li>Specify a mountpoint. Recommended is a 4-character station ID. Example: FFMJ</li>
<li>Specify the stream format. Available options are 'RTCM_2', 'RTCM_3', 'RTIGS', and 'ZERO'.</li>
<li>Enter the approximate latitude of the stream providing rover in degrees. Example: 45.32.</li>
<li>Enter the approximate longitude of the stream providing rover in degrees. Example: -15.20.</li>
</ul>
</p>
<p>
Streams directly received at a UDP port show up with a 'UN' for 'UDP, No NTRIP' in the 'Streams' canvas section on BNC's main window . Latitude and longitude are to be entered just for informal reasons.
<p>

<p><a name="streamser"><h4>3.14.4 Add Stream - Coming from Serial Port</h4></p>
<p>
Button 'Add Stream' &gt; 'Coming from Serial Port' allows to retrieve streams from a GNSS receiver via serial port without using the NTRIP transport protocol. For that you:
<ul>
<li>Specify a mountpoint. Recommended is a 4-character station ID. Example: FFMJ</li>
<li>Specify the stream format. Available options are 'RTCM_2', 'RTCM_3', 'RTIGS', and 'ZERO'.</li>
<li>Enter the approximate latitude of the stream providing receiver in degrees. Example: 45.32.</li>
<li>Enter the approximate longitude of the stream providing receiver in degrees. Example: -15.20.</li>
<li>Enter the serial 'Port name' selected on your host for communication with the receiver. Valid port names are
<pre>
Windows:       COM1, COM2
Linux:         /dev/ttyS0, /dev/ttyS1
FreeBSD:       /dev/ttyd0, /dev/ttyd1
Digital Unix:  /dev/tty01, /dev/tty02
HP-UX:         /dev/tty1p0, /dev/tty2p0
SGI/IRIX:      /dev/ttyf1, /dev/ttyf2
SunOS/Solaris: /dev/ttya, /dev/ttyb
</pre>
</li>
<li>Select a 'Baud rate' for the serial input. Note that using a high baud rate is recommended.</li>
<li>Select the number of 'Data bits' for the serial input. Note that often '8' data bits are used.</li>
<li>Select the 'Parity' for the serial input. Note that parity is often set to 'NONE'.</li>
<li>Select the number of 'Stop bits' for the serial input. Note that often '1' stop bit is used.</li>
<li>Select a 'Flow control' for the serial link. Select 'OFF' if you don't know better.</li>
</ul>
</p>
<p>
When selecting the serial communication options listed above, make sure that you pick those configured to the serial connected GNSS receiver. 
</p>

<p>
Streams received from a serial connected GNSS receiver show up with an 'S' (for <u>S</u>erial Port, no NTRIP) in the 'Streams' canvas section on BNC's main window . Latitude and longitude are to be entered just for informal reasons.
<p>

<p>
The following figure shows a BNC example setup for pulling a stream via serial port on a Linux operating system.
</p>
<p><img src=":bnchelp/screenshot15.png"/></p>
<p><u>Figure:</u> BNC setup for pulling a stream via serial port.</p>

<p><a name="start"><h4>3.14.5 Start</h4></p>
<p>
Hit 'Start' to start retrieving, decoding, and converting GNSS data streams in real-time. Note that 'Start' generally forces BNC to begin with fresh RINEX which might overwrite existing files when necessary unless the option 'Append files' is ticked.
</p> 

<p><a name="stop"><h4>3.14.6 Stop</h4></p>
<p>
Hit the 'Stop' button in order to stop BNC. 
</p> 

<p><a name="cmd"><h4>3.15. Command Line Options</h4></p>
<p> 
Command line options are available to run BNC in 'no window' mode or let it read data from a file in offline mode. BNC will then use processing options from the configuration file. Note that the self-explaining contents of the configuration file can easily be edited. It is possible to introduce a specific configuration file name instead of using the default name 'BNC.ini'.
</p> 

<p><a name="nw"><h4>3.15.1 No Window Mode - optional</h4></p>
<p>
Apart from its regular windows mode, BNC can be started on all systems as a background/batch job with command line option '-nw'. BNC will then run in 'no window' mode, using processing options from its configuration file on disk. Terminate BNC using Windows Task Manager when running it in 'no window' mode on Windows systems.
</p> 
<p> 
Example:<br><br>
bnc.exe -nw
</p>

<p><a name="post"><h4>3.15.2 Offline Mode - optional</h4></p>
<p>
Although BNC is primarily a real-time online tool, it can be run in offline mode to read data from a previously saved file for post-processing purposes. Enter the following command line options for that:
</p>
<p>
<ul>
<li>'--file &lt;<u>inputFileName</u>&gt;' to enter the full path to an input file containing data previously saved by BNC.</li>
<li>'--format &lt;<u>format</u>&gt;' to enter one of the file format describing strings 'RTCM_2', 'RTCM_3' or 'RTIGS'.</li>
</ul>
<p>
Example:<br><br>
./bnc --file FFMJ.dat --format RTCM_3
</p>
<p>
Note that when running BNC in offline mode, it will use options for file saving, interval, sampling, PPP etc. from its configuration file. Note further that only those data in the file will be processd offline which are encoded as specified with the --format option. 
</p> 

<p><a name="conffile"><h4>3.15.3 Configuration File - optional</h4></p>
The default configuration file name is 'BNC.ini'. You may change this name at startup time using the command line option '--conf &lt;<u>confFileName</u>&gt;'. This allows to run several BNC jobs in parallel on the same host using different sets of configuration options. <u>confFileName</u> stands either for the full path to a configuration file or just for a file name. If you introduce only a filename, the corresponding file will be saved in the current working directory from where BNC is started.
</p>
<p>
Example:<br><br>
./bnc --conf MyConfig.ini
</p> 
<p> 
This leads to a BNC job using configuration file 'MyConfig.ini'. The configuration file will be saved in the current working directory.
</p> 
<p> 
On a Mac-OS X v10.6 (or higher) system the command line would be
<br><br> 
open -a /Applications/bnc.app --args -conf /Users/tsyan/MyConfig.ini
<br><br>
if the program is in /Applications and the configuration file 'MyConfig.ini' in /Users/tsyan.
</p> 

<p><a name="limits"><h3>4. Limitations &amp; Known Bugs</h3></p>
<ul>
<li>
In Qt-based desktop environments (like KDE) on Unix/Linux platforms it may happen that you experience a crash of BNC at startup even when running the program in the background using the '-nw' option. This is a known bug most likely resulting from an incompatibility of Qt libraries in the environment and in BNC. Entering the command 'unset SESSION_MANAGER' before running BNC may help as a work-around. 
</li>
<li>
Currently BNC only handles GPS, SBAS and GLONASS data. Galileo is not yet supported.
</li>
<li>
BNC currently will only handle C1, C2, P1, P2, L1, L2, S1, and S2 observations as well as the cumulative loss of continuity and lock time indicators. Which observables and indicators are available on a particular stream will depend on the setup of source receiver and the data format used. RTCM Version 2.x streams do not carry signal-to-noise ratio 'S' values while RTCM Version 3.x streams can only transport one code observable per frequency. Note that signal-to-noise ratios 'S' are also logged mapped to integer numbers 1 to 9.
</li>
<li>
Using RTCM Version 3.x, BNC will properly handle message types 1002, 1004, 1010, and 1012. Note that when handling message types 1001, 1003, 1009 and 1011 where the ambiguity field is not set, the output will be no valid RINEX. All values will be stored modulo 299792.458 (speed of light).
</li>
Concerning the RTCM Version 3.x premature message types 1057-1068 (see RTCM document 091-2009-SC104-542 'Version 3 Proposed Messages - Set 10'), a final decision is not yet made. Note the what's implemented in BNC is just a temporary solutions.
<li>
Using RTCM Version 2.x, BNC will only handle message types 18 and 19 or 20 and 21 together with position and the antenna offset information carried in types 3 and 22. Note that processing carrier phase corrections and pseudo-range corrections contained in message types 20 and 21 needs access to broadcast ephemeris. Hence, whenever dealing with message types 20 and 21, make sure that broadcast ephemeris become available for BNC through also retrieving at least one RTCM Version 3.x stream carrying message types 1019 (GPS ephemeris) and 1020 (GLONASS ephemeris).
</li>
<li>
Streams coming in RTIGS format carry only GPS data.
</li>
<li>
BNC's 'Get Table' function only shows the STR records of a source-table. You can use an Internet browser to download the full source-table contents of any NTRIP broadcaster by simply entering its URL in the form of <u>http://host:port</u>. Data field number 8 in the NET records may provide information about where to register for an NTRIP broadcaster account.
</li>
<li>
EUREF as well as IGS adhere to an open data policy. Streams are made available through NTRIP broadcasters at <u>www.euref-ip.net</u>, <u>www.igs-ip.net</u> and <u>products.igs-ip.net</u> free of charge to anyone for any purpose. There is no indication up until now how many users will need to be supported simultaneously. The given situation may develop in such a way that it might become difficult to serve all registered users at the same times. In cases where limited resources on the NTRIP broadcaster side (software restrictions, bandwidth limitation etc.) dictates, first priority in stream provision will be given to stream providers followed by re-broadcasting activities and real-time analysis centers while access to others might be temporarily denied.
</li>
<li>
We experienced a limitation of the Standard Version of Microsoft Windows related to socket communication where sockets are not always handled properly. Since BNC makes intensive use of communication through sockets, we recommend to use the Server Version of Microsoft Windows when running BNC continuously for extended on a Windows platform.
</li>
<li>
The source code provided by NRCan for decoding RTIGS streams is 32-bit dependent. Hence the BNC executable generated for 64-bit Linux systems would only run when compiled using the -m32 compiler option. 
</li>
<li>
Once BNC has been started, many of its configuration options cannot be changed as long as it is stopped. See chapter 'Reread Configuration' for on-the-fly configuration exceptions.
</li>
<li>
On Mac systems you may experience a problem in passing a specific configuration file to the BNC application. On a Mac OS X 10.6 (or higher) system, you may then like to try the following command line to launch BNC:<br>
open -a /Applications/bnc.app --args -conf /Users/tsyan/MyConfig.ini<br>
(if the program is in /Applications and the configuration file 'MyConfig.ini' in /Users/tsyan)
</li>

</ul>
<p><a name="authors"><h3>5. Authors</h3></p>
<p>
The BKG Ntrip Client (BNC) Qt Graphic User Interface (GUI) has been developed for the Federal Agency for Cartography and Geodesy (BKG) by Leos Mervart, Czech Technical University Prague, Department of Geodesy. BNC includes the following GNU GPL software components: 
<ul>
<li> RTCM 2.x decoder, written by Oliver Montenbruck, German Space Operations Center, DLR, Oberpfaffenhofen</li> 
<li> RTCM 3.x decoder, written for BKG by Dirk Stoecker, Alberding GmbH, Schoenefeld</li> 
<li> RTIGS decoder, written by Ken MacLeod, Natural Resources, Canada.</li> 
</ul>
</p>
<p>
Georg Weber<br>
Federal Agency for Cartography and Geodesy (BKG)<br>
Frankfurt, Germany<br>
[euref-ip@bkg.bund.de] or [igs-ip@bkg.bund.de]
</p>
<p>
<b>Acknowledgements</b><br>
BNC's Help Contents has been proofread by Thomas Yan, University of New South Wales, Australia.<br>
Scott Glazier, OmniSTAR Australia, included the decoding of broadcast ephemeris from RTIGS streams and has been helpful in finding BNC's bugs.<br>
James Perlt, BKG, helped fixing bugs and redesigned BNC's main window.<br>
Andre Hauschild, German Space Operations Center, DLR, revised the RTCMv2 decoder.<br>
Zdenek Lukes, Czech Technical University Prague, Department of Geodesy, extended the RTCMv2 decoder to handle message types 3, 20, 21, and 22 and added loss of lock indicator.<br>
</p>

<p><a name="annex"><h3>6. Annex</h3></p>
<p>
6.1. <a href=#history>Revision History</a><br>
6.2. <a href=#rtcm>RTCM</a><br>
&nbsp; &nbsp; &nbsp; 6.2.1 NTRIP <a href=#ntrip1>Version 1</a><br>
&nbsp; &nbsp; &nbsp; 6.2.2 NTRIP <a href=#ntrip2>Version 2</a><br>
&nbsp; &nbsp; &nbsp; 6.2.3 RTCM <a href=#rtcm2>Version 2.x</a><br>
&nbsp; &nbsp; &nbsp; 6.2.4 RTCM <a href=#rtcm3>Version 3.x</a><br>
6.3. <a href=#rtigs>RTIGS</a><br>
&nbsp; &nbsp; &nbsp; 6.3.1 <a href=#soc>SOC</a><br>
6.4. <a href=#config>Configuration Example</a><br>
6.5. <a href=#links>Links</a><br>
</p>

<p><a name=history><h3>6.1 Revision History</h3></p>
<table>
<tr></tr>

<tr>
<td>Dec 2006 &nbsp;</td><td>Version 1.0b &nbsp;</td>
<td>[Add] First Beta Binaries published based on Qt 4.2.3.</td>
</tr>

<tr>
<td>Jan 2007 &nbsp;</td><td>Version 1.1b &nbsp;</td>
<td>[Add] Observables C2, S1, and S2<br>[Add] Virtual reference station access<br>[Bug] RTCM2 decoder time tag fixed<br>[Mod] Small letters for public RINEX skeleton files<br>[Add] Online help through Shift+F1</td>
</tr>

<tr>
<td>Apr 2007 &nbsp;</td><td>Version 1.2b &nbsp;</td>
<td>[Bug] Output only through IP port<br>[Bug] Method 'reconnecting' now thread-save<br> [Add] ZERO decoder added<br> [Mod] Download public RINEX skeletons once per day<br> [Mod] Upgrade to Qt Version 4.2.3<br> [Mod] Replace 'system' call for RINEX script by 'QProcess'<br> [Add] HTTP Host directive for skeleton file download<br> [Add] Percent encoding for user IDs and passwords<br> [Bug] Exit execution of calling thread for RTCM3 streams<br> [Bug] Signal-slot mechanism for threads</td>
</tr>

<tr>
<td>May 2007 &nbsp;</td><td>Version 1.3 &nbsp;</td>
<td>[Add] Source code published.</td>
</tr>

<tr>
<td>Jul 2007 &nbsp;</td><td>Version 1.4 &nbsp;</td>
<td>[Bug] Skip messages from proxy server<br> [Bug] Call RINEX script through 'nohup'</td>
</tr>

<tr>
<td>Apr 2008 &nbsp;</td><td>Version 1.5 &nbsp;</td>
<td>[Add] Handle ephemeris from RTCM Version 3.x streams<br> [Add] Upgrade to Qt Version 4.3.2<br> [Add] Optional RINEX v3 output<br> [Add] SBAS support<br> [Bug] RINEX skeleton download following stream outage<br> [Add] Handle ephemeris from RTIGS streams<br> [Add] Monitor stream failure/recovery and latency<br> [Mod] Redesign of main window<br> [Bug] Freezing of About window on Mac systems<br> [Bug] Fixed problem with PRN 32 in RTCMv2 decoder<br> [Bug] Fix for Trimble 4000SSI receivers in RTCMv2 decoder<br> [Mod] Major revision of input buffer in RTCMv2 decoder</td>
</tr>

<tr>
<td>Dec 2008 &nbsp;</td><td>Version 1.6 &nbsp;</td>
<td>[Mod] Fill blanc columns in RINEXv3 with 0.000<br> [Add] RTCMv3 decoder for clock and orbit corrections<br>[Add] Check RTCMv3 streams for incoming message types<br> [Add] Decode RTCMv2 message types 3, 20, 21, and 22<br> [Add] Loss of lock and lock time indicator<br> [Bug] Rounding error in RTCMv3 decoder concerning GLONASS height<br> [Mod] Accept GLONASS in RTCMv3 when transmitted first<br> [Add] Leap second 1 January 2009<br> [Add] Offline mode, read data from file<br> [Add] Output antenna descriptor, coordinates and excentricities from RTCMv3<br> [Add] Reconfiguration on-the-fly<br> [Mod] Binary output of synchronized observations<br> [Add] Binary output of unsynchronized observations<br> [Bug] Fixed problem with joined RTCMv3 blocks</td>
</tr>

<tr>
<td>Dec 2008 &nbsp;</td><td>Version 1.6.1 &nbsp;</td>
<td>[Mod] HTTP GET when no proxy in front</td>
</tr>

<tr>
<td>Nov 2009 &nbsp;</td><td>Version 1.7 &nbsp;</td>
<td>[Bug] RINEX navigation file format<br> [Add] Upgrade to Qt Version 4.5.2<br> [Add] Support of NTRIP v2<br> [Add] Rover support via serial port<br> [Add] Show broadcaster table from www.rtcm-ntrip.org<br> [Add] Enable/disable tab widgets<br> [Add] User defined configuration file name<br> [Mod] Switch to configuration files in ini-Format<br> [Add] Daily logfile rotation<br> [Add] Read from TCP/IP port, by-pass NTRIP transport protocol<br> [Add] Save NMEA messages coming from rover<br> [Add] Auto start<br> [Add] Drag and drop ini files<br> [Add] Read from serial port, by-pass NTRIP transport protocol<br> [Mod] Update of SSR messages following RTCM 091-2009-SC104-542<br> [Add] Read from UPD port, by-pass NTRIP transport protocol<br> [Mod] Output format of Broadcast Corrections<br> [Add] Throughput plot<br> [Add] Latency plot</td>
</tr>

<tr>
<td>Nov 2009 &nbsp;</td><td>Version 1.8 &nbsp;</td>
<td>[Mod] On-the-fly reconfiguration of latency and throughput plots</td>
</tr>

<tr>
<td>Feb 2010 &nbsp;</td><td>Version 2.0 &nbsp;</td>
<td>[Mod] Change sign of Broadcast Ephemeris correctors<br> [Add] Real-time PPP option</td>
</tr>

<tr>
<td>Jun 2010 &nbsp;</td><td>Version 2.1 &nbsp;</td>
<td>[Bug] SSR GLONASS message generation<br> [Add] PPP in post-processing mode<br> [Mod] Update of SSR messages following draft dated 2010-04-12<br> [Mod] Generating error message when observation epoch is wrong</td>
</tr>

<tr>
<td>Jul 2010 &nbsp;</td><td>Version 2.2 &nbsp;</td>
<td>[Bug] GLONASS ephemeris time</td>
</tr>

<tr>
<td>Aug 2010 &nbsp;</td><td>Version 2.3 &nbsp;</td>
<td>[Mod] Internal format for saving raw streams<br> [Bug] Outlier detection in GLONASS ambiguity resolution<br> [Mod] Format of PPP logs in logfile<br> [Bug] Complete acceleration terms for GLONASS ephemeris<br> [Bug] Handling ephemeris IOD's in PPP mode</td>
</tr>

<tr>
<td>Nov 2010 &nbsp;</td><td>Version 2.4 &nbsp;</td>
<td>[Add] Output of averaged positions when in PPP mode<br> [Mod] Use always the latest received set of broadcast ephemeris<br> [Add] QuickStart PPP option</td>
</tr>

</table>
</p>

<p><a name="rtcm"><h4>6.2. RTCM</h4></p>

<p>
The Radio Technical Commission for Maritime Services (RTCM) is an international non-profit scientific, professional and educational organization. Special Committees provide a forum in which governmental and non-governmental members work together to develop technical standards and consensus recommendations in regard to issues of particular concern. RTCM is engaged in the development of international standards for maritime radionavigation and radiocommunication systems. The output documents and reports prepared by RTCM Committees are published as RTCM Recommended Standards. Topics concerning Differential Global Navigation Satellite Systems (DGNSS) are handled by the Special Committee SC 104.
<p>
Personal copies of RTCM Recommended Standards can be ordered through <u>http://www.rtcm.org/orderinfo.php</u>.
</p>

<p><a name="ntrip1"><h4>6.2.1 NTRIP Version 1</h4></p>

<p>
'Networked Transport of RTCM via Internet Protocol' Version 1.0 (NTRIP) stands for an application-level protocol streaming Global Navigation Satellite System (GNSS) data over the Internet. NTRIP is a generic, stateless protocol based on the Hypertext Transfer Protocol HTTP/1.1. The HTTP objects are enhanced to GNSS data streams.
</p>

<p>
NTRIP Version 1.0 is an RTCM standard designed for disseminating differential correction data (e.g. in the RTCM-104 format) or other kinds of GNSS streaming data to stationary or mobile users over the Internet, allowing simultaneous PC, Laptop, PDA, or receiver connections to a broadcasting host. NTRIP supports wireless Internet access through Mobile IP Networks like GSM, GPRS, EDGE, or UMTS.
</p>

<p>
NTRIP is implemented in three system software components: NTRIP clients, NTRIP servers and NTRIP broadcasters. The NTRIP broadcaster is the actual HTTP server program whereas NTRIP client and NTRIP server are acting as HTTP clients.
</p>

<p>
NTRIP is an open none-proprietary protocol. Major characteristics of NTRIP's dissemination technique are:
<ul>
<li>Based on the popular HTTP streaming standard; comparatively easy to implement when having limited client and server platform resources available.</li>
<li>Application not limited to one particular plain or coded stream content; ability to distribute any kind of GNSS data.</li>
<li>Potential to support mass usage; disseminating hundreds of streams simultaneously for thousands of users possible when applying modified Internet Radio broadcasting software.</li>
<li>Considering security needs; stream providers and users don't necessarily get into contact, streams often not blocked by firewalls or proxy servers protecting Local Area Networks.</li>
<li>Enables streaming over mobile IP networks because of using TCP/IP.</li>
</ul>
</p>

<p>
The NTRIP broadcaster maintains a source-table containing information on available NTRIP streams, networks of NTRIP streams and NTRIP broadcasters. The source-table is sent to an NTRIP client on request. Source-table records are dedicated to one of the following: Data Streams (record type STR), Casters (record type CAS), or Networks of streams (record type NET).
</p>

<p>
Source-table records of type STR contain the following data fields: 'mountpoint', 'identifier', 'format', 'format-details', 'carrier', 'nav-system', 'network', 'country', 'latitude', 'longitude', 'nmea', 'solution', 'generator', 'compr-encryp', 'authentication', 'fee', 'bitrate', 'misc'.
</p>
<p>
Source-table records of type NET contain the following data fields: 'identifiey', 'operator', 'authentication', 'fee', 'web-net', 'web-str', 'web-reg', 'misc'.
</p>
<p>
Source-table records of type CAS contain the following data fields: 'host', 'port', 'identifier', 'operator', 'nmea', 'country', 'latitude', 'longitude', 'misc'.
</p>

<p><a name="ntrip2"><h4>6.2.1 NTRIP Version 2</h4></p>

<p>
The major changes of NTRIP version 2.0 compared to version 1.0 are:
</p>

<ul>
<li>cleared and fixed design problems and HTTP protocol violations;</li>
<li>replaced non standard directives;</li>
<li>chunked transfer encoding;</li>
<li>improvements in header records;</li>
<li>source-table filtering; and</li>
<li>RTSP communication.</li>
</ul>

<p>NTRIP version 2 allows to either communicate in TCP/IP mode or in RTSP/RTP mode or in UDP mode whereas version 1 is limited to TCP/IP only.
</p>

<p><a name="rtcm2"><h4>6.2.3 RTCM Version 2.x</h4></p>
<p>
Transmitting GNSS carrier phase data can be done through RTCM Version 2.x messages. Please note that only RTCM Version 2.2 and 2.3 streams may include GLONASS data. Messages that may be of some interest here are:
</p>

<ul>
<li>
Type 1 message is the range correction message and is the primary message in code-phase differential positioning (DGPS). It is computed in the base receiver by computing the error in the range measurement for each tracked SV.
</li>
<li>
Type 2 message is automatically generated when a new set of satellite ephemeris is downloaded to the base receiver. It is the computed difference between the old ephemeris and the new ephemeris. Type 2 messages are used when the base station is transmitting Type 1 messages.
</li>
<li>
Type 3 and 22 messages are the base station position and the antenna offset. Type 3 and 22 are used in RTK processing to perform antenna reduction.
</li>
<li>
Type 6 message is a null frame filler message that is provided for data links that require continuous transmission of data, even if there are no corrections to send. As many Type 6 messages are sent as required to fill in the gap between two correction messages (type 1). Message 6 is not sent in burst mode.
</li>
<li>
Type 9 message serves the same purpose as Type 1, but does not require a complete satellite set. As a result, Type 9 messages require a more stable clock than a station transmitting Type 1 's, because the satellite corrections have different time references.
</li>
<li>
Type 16 message is simply a text message entered by the user that is transmitted from the base station to the rover. It is used with code-phase differential.
</li>
<li>
Type 18 and 20 messages are RTK uncorrected carrier phase data and carrier phase corrections.
</li>
<li>
Type 19 and 21 messages are the uncorrected pseudo-range measurements and pseudo-range corrections used in RTK.
</li>
<li>
Type 23 message provides the information on the antenna type used on the reference station. 
</li>
<li>
Type 24 message carries the coordinates of the installed antenna's ARP in the GNSS coordinate system coordinates.
</li>
</ul>

<p><a name="rtcm3"><h4>6.2.4 RTCM Version 3.x</h4></p>
<p>
RTCM Version 3.x has been developed as a more efficient alternative to RTCM Version 2.x. Service providers and vendors have asked for a standard that would be more efficient, easy to use, and more easily adaptable to new situations. The main complaint was that the Version 2 parity scheme was wasteful of bandwidth. Another complaint was that the parity is not independent from word to word. Still another was that even with so many bits devoted to parity, the actual integrity of the message was not as high as it should be. Plus, 30-bit words are awkward to handle. The Version 3.x standard is intended to correct these weaknesses.
</p>
<p>
RTCM Version 3.x defines a number of message types. Messages that may be of interest here are:
<ul>
<li>Type 1001, GPS L1 code and phase.</li>
<li>Type 1002, GPS L1 code and phase and ambiguities and carrier to noise ratio.</li>
<li>Type 1003, GPS L1 and L2 code and phase.</li>
<li>Type 1004, GPS L1 and L2 code and phase and ambiguities and carrier to noise ratio.</li>
<li>Type 1005, Station coordinates XZY for antenna reference point.</li>
<li>Type 1006, Station coordinates XYZ for antenna reference point and antenna height.</li>
<li>Type 1007, Antenna descriptor and ID.</li>
<li>Type 1008, Antenna serial number.</li>
<li>Type 1009, GLONASS L1 code and phase.</li>
<li>Type 1010, GLONASS L1 code and phase and ambiguities and carrier to noise ratio.</li>
<li>Type 1011, GLONASS L1 and L2 code and phase.</li>
<li>Type 1012, GLONASS L1 and L2 code and phase and ambiguities and carrier to noise ratio.</li>
<li>Type 1013, Modified julian date, leap second, configured message types and interval.</li>
<li>Type 1014 and 1017, Network RTK (MAK) messages (under development).</li>
<li>Type 1019, GPS ephemeris.</li>
<li>Type 1020, GLONASS ephemeris.</li>
<li>Type 4088 and 4095, Proprietary messages (under development).
</li>
</ul>
</p>

<p>
The following are proposed 'Multiple System Messages' (MSM) under discussion for standardization:
<ul>
<li>Type 1071, Compact GPS pseudo-ranges</li>
<li>Type 1072, Compact GPS carrier phases</li>
<li>Type 1073, Compact GPS pseudo-ranges and carrier phases</li>
<li>Type 1074, Full GPS pseudo-ranges and carrier phases plus signal strength</li>
<li>Type 1075, Full GPS pseudo-ranges, carrier phases, Doppler and signal strength</li>
<li>Type 1076, Full GPS pseudo-ranges and carrier phases plus signal strength (high resolution)</li>
<li>Type 1077, Full GPS pseudo-ranges, carrier phases, Doppler and signal strength (high resolution)<br></li>
<li>Type 1081, Compact GLONASS pseudo-ranges</li>
<li>Type 1082, Compact GLONASS carrier phases</li>
<li>Type 1083, Compact GLONASS pseudo-ranges and carrier phases</li>
<li>Type 1084, Full GLONASS pseudo-ranges and carrier phases plus signal strength</li>
<li>Type 1085, Full GLONASS pseudo-ranges, carrier phases, Doppler and signal strength</li>
<li>Type 1086, Full GLONASS pseudo-ranges and carrier phases plus signal strength (high resolution)</li>
<li>Type 1087, Full GLONASS pseudo-ranges, carrier phases, Doppler and signal strength (high resolution)<br></li>
<li>Type 1091, Compact GALILEO pseudo-ranges</li>
<li>Type 1092, Compact GALILEO carrier phases</li>
<li>Type 1093, Compact GALILEO pseudo-ranges and carrier phases</li>
<li>Type 1094, Full GALILEO pseudo-ranges and carrier phases plus signal strength</li>
<li>Type 1095, Full GALILEO pseudo-ranges, carrier phases, Doppler and signal strength</li>
<li>Type 1096, Full GALILEO pseudo-ranges and carrier phases plus signal strength (high resolution)</li>
<li>Type 1097, Full GALILEO pseudo-ranges, carrier phases, Doppler and signal strength (high resolution)<br></li>
</ul>
</p>

<p>
The following are proposed 'State Space Representation' (SSR) messages under discussion for standardization:
<ul>
<li>Type 1057, GPS orbit corrections to Broadcast Ephemeris</li>
<li>Type 1058, GPS clock corrections to Broadcast Ephemeris</li>
<li>Type 1059, GPS code biases</li>
<li>Type 1060, Combined orbit and clock corrections to GPS Broadcast Ephemeris</li>
<li>Type 1061, GPS User Range Accuracy (URA)</li>
<li>Type 1062, High-rate GPS clock corrections to Broadcast Ephemeris</li>
<li>Type 1063, GLONASS orbit corrections to Broadcast Ephemeris</li>
<li>Type 1064, GLONASS clock corrections to Broadcast Ephemeris</li>
<li>Type 1065, GLONASS code biases</li>
<li>Type 1066, Combined orbit and clock corrections to GLONASS Broadcast Ephemeris</li>
<li>Type 1067, GLONASS User Range Accuracy (URA)</li>
<li>Type 1068, High-rate GLONASS clock corrections to Broadcast Ephemeris</li>
</ul>
</p>

<p><a name="rtigs"><h4>6.3. RTIGS</h4></p>
<p>
RTIGS stands for a data format and transport protocol for GPS observations. It was defined by the Real-Time IGS Working Group (RTIGS WG). Its definition is based on the SOC format. Every RTIGS record has one of the following numbers:
</p>
<p>
Station record number 100<br>
Observation record (O_T) number 200<br>
Ephemeris record (E_T) number 300<br>
Meteorological record (M_T) number 400
</p>
<p>
Every station has one of the following unique numbers:
</p>
<p>
1-99 reserved for JPL<br>
100-199 reserved for NRCan<br>
200-299 reserved for NGS<br>
300-399 reserved for ESOC<br>
400-499 reserved for GFZ<br>
500-599 reserved for BKG<br>
600-699 reserved for GEOSCIENCE AUS<br>
700-799 others<br>
etc
</p>
<p>
The number of bytes in each real time message includes the header as well as the data content, but NOT the pointer. 
</p>
<p>
For example:
</p>
<ul>
<li>A station message is output once per hour and is 20 bytes.</li>
<li>An observation message is output once per second. The header is 12 bytes long and the SOC data is 21 bytes per PRN. So a typical RTIGSO_T message will be 390 bytes if 8 sats are being tracked.</li>
<li>An ephemeris message is output when the ephemeris is decoded by the GPS receiver. The time in the ephemeris header is the collected time. Only one ephemeris can be bundled in a RTIGSE_T message.<br>
A RTIGSE_T message contains one eph. The message consists of 12 header bytes and 72 ephemeris bytes, for a total of 84 bytes.</li>
<li>The RTIGSM_T (met) message should be issued once every 15 minutes. A basic met message consists of a 12 byte header and 3 longs (temp, press and relative humidity) for a total of 24 bytes.</li>
</ul>
<p>
All records are related to a station configuration indicated by the Issue of Data Station (IODS). The IODS will enable the user to identify the equipment and software that was used to derive the observation data.
</p>
<p>
Each record header contains the GPS Time in seconds which flows continuously from 6 Jan-1980 onwards.
</p>
<p>
The data payload of each record consists of observations. The structures indicate a pointer to data but in fact the broadcast messages do not contain the pointer, only the data. Users will have to manage the data and the pointer is shown in order to illustrate where the data is located in the message and one possible data management option.
</p>
<p>
All record data are in network byte order (Big Endian), i.e. IA32 users have to swap bytes.
</p>
<p>
Visit <u>http://igscb.jpl.nasa.gov/mail/igs-rtwg/2004/msg00001.html</u> for further details.
</p>

<p><a name="soc"><h4>6.3.1 SOC</h4></p>
<p>
The SOC format has been designed in July 1999 by the Jet Propulsion Laboratory (JPL) and the California Institute of Technology (CalTech) to transport 1Hz GPS data with minimal bandwidth over the open Internet. SOC follows the 'little-endian' byte order meaning that the low-order byte of a number is stored in memory at the lowest address, and the high-order byte at the highest address. Because the transport layer is UDP, the format does not include sync bits, a checksum, or cyclic redundancy checksum (CRC). SOC allows to transport the GPS observable CA, P1, P2, L1, and L2, efficiently compressed down to 14 bytes with 1 mm range resolution and 0.02 mm phase resolution. SOC contains epochs for cycle slips, a stand-alone time-tag per epoch, a minimum representation of the receiver's clock solution, 3 SNR numbers, a unique site id, a modulo 12 hour sequence number and flags for receiver type and GPS health. SOC's simple structure comprises an 8 byte header, a 9 byte overhead for timetag, number of gps, etc., plus 21 data bytes per gps.
</p>
<p>
Visit <u>http://gipsy.jpl.nasa.gov/igdg/papers/SOC_FORMAT.ppt</u> for further details.
</p>
<p>
</p>
<p><a name="config"><h4>6.4. Configuration Example</h4></p>
<p>
The following table's left column is an example for the contents of a configuration file 'BNC.ini'. It enables the retrieval of stream ACOR0 form www.euref-ip.net for the generation of 15 min RINEX files. RINEX files are uploaded to an archive using script 'up2archive' :
</p>
<table>
<tr></tr>
<tr><td><b>Option</b></td><td><b>Affiliation</b></td></tr>
<tr><td>[General]</td><td>Settings: Group</td></tr>
<tr><td>adviseFail=15</td><td>Outages: Failure threshold</td></tr>
<tr><td>adviseReco=5</td><td>Outages: Recovery threshold</td></tr>
<tr><td>adviseScript=</td><td>Outages: Script (full path)</td></tr>
<tr><td>autoStart=0</td><td>General: Auto start</td></tr>
<tr><td>binSample=0</td><td>Feed Engine: Sampling</td></tr>
<tr><td>casterUrlList=http://user:pass@euref-ip:2101</td><td>Internal memory: Visited URLs</td></tr>
<tr><td>corrIntr=1 day</td><td>Broadcast Corrections: Interval</td></tr>
<tr><td>corrPath=</td><td>Broadcast Corrections: Directory </td></tr>
<tr><td>corrPort=</td><td>Broadcast Corrections: Port</td></tr>
<tr><td>corrTime=5</td><td>Broadcast Corrections: Wait for full epoch</td></tr>
<tr><td>ephIntr=15 min</td><td>RINEX Ephemeris: Interval</td></tr>
<tr><td>ephPath=</td><td>RINEX Ephemeris: Directory</td></tr>
<tr><td>ephV3=0</td><td>RINEX Ephemeris: Version 3</td></tr>
<tr><td>font=</td><td>Internal memory: Used font</td></tr>
<tr><td>logFile=/home/weber/bnc.log</td><td>General: Logfile (full path)</td></tr>
<tr><td>rawOutFile=</td><td>General: Raw output file (full path)</td></tr>
<tr><td>miscMount=</td><td>Miscellaneous: Mountpoint</td></tr>
<tr><td>mountPoints=//user:pass@www.euref-ip.net:2101<br>/ACOR0 RTCM_2.3 43.36 351.60 no 1</td><td>Streams: broadcaster:port/mountpoint</td></tr>
<tr><td>ntripVersion=1</td><td>Add Stream: NTRIP Version</td></tr>
<tr><td>obsRate=</td><td>Outages: Observation rate</td></tr>
<tr><td>onTheFlyInterval=1 day</td><td>General: Reread configuration</td></tr>
<tr><td>outEphPort=</td><td>RINEX Ephemeris: Port</td></tr>
<tr><td>outFile=</td><td>Feed Engine: File (full path)</td></tr>
<tr><td>outPort=</td><td>Feed Engine: Port</td></tr>
<tr><td>outUPort=</td><td>Feed Engine: Port (unsynchronized)</td></tr>
<tr><td>perfIntr=</td><td>Miscellaneous: Log latency</td></tr>
<tr><td>proxyHost=</td><td>Proxy: Proxy host</td></tr>
<tr><td>proxyPort=</td><td>Proxy: Proxy port</td></tr>
<tr><td>rnxAppend=2</td><td>General: Append files</td></tr>
<tr><td>rnxIntr=15 min</td><td>RINEX Observations: Interval</td></tr>
<tr><td>rnxPath=/home/user/rinex</td><td>RINEX Observations: Directory</td></tr>
<tr><td>rnxSample=0</td><td>RINEX Observations: Sampling</td></tr>
<tr><td>rnxScript=/home/user/rinex/up2archive</td><td>RINEX Observations: Script (full path)</td></tr>
<tr><td>rnxSkel=</td><td>RINEX Observations: Skeleton extension</td></tr>
<tr><td>rnxV3=0</td><td>RINEX Observation: Version 3</td></tr>
<tr><td>scanRTCM=0</td><td>Miscellaneous: Scan RTCM</td></tr>
<tr><td>serialAutoNMEA=Auto</td><td>Serial Output: NMEA</td></tr>
<tr><td>serialBaudRate=9600</td><td>Serial Output: Baud rate</td></tr>
<tr><td>serialDataBits=8</td><td>Serial Output: Data bits</td></tr>
<tr><td>serialHeightNMEA=</td><td>Serial Output: Height</td></tr>
<tr><td>serialMountPoint=</td><td>Serial Output: Mountpoint</td></tr>
<tr><td>serialParity=NONE</td><td>Serial Output: Parity</td></tr>
<tr><td>serialPortName=</td><td>Serial Output: Port name</td></tr>
<tr><td>serialStopBits=1</td><td>Serial Output: Stop bits</td></tr>
<tr><td>startTab=0</td><td>Internal memory: Top tab index</td></tr>
<tr><td>statusTab=0</td><td>Internal memory: Bottom tab index</td></tr>
<tr><td>waitTime=5</td><td>Feed Engine: Wait for full epoch</td></tr>
<tr><td>pppMount=</td><td>PPP Client: Mountpoint</td></tr>
<tr><td>pppSPP=</td><td>PPP Client: PPP/SPP</td></tr>
<tr><td>pppStatic=0</td><td>PPP Client: Static mode</td></tr>
<tr><td>pppUsePhase=0</td><td>PPP Client: Use phase data </td></tr>
<tr><td>pppEstTropo=0</td><td>PPP Client: Estimate troposphere</td></tr>
<tr><td>pppGLONASS=0</td><td>PPP Client: Use GLONASS</td></tr>
<tr><td>pppSigmaCode=0</td><td>PPP Client: Sigma for Code observations</td></tr>
<tr><td>pppAverage=</td><td>PPP Client: Lenght of time window for moving average</td></tr>
<tr><td>pppOrigin=</td><td>PPP Client: Origin of time series plot</td></tr>
<tr><td>pppRefCrdX=</td><td>PPP Client: X coordinate of plot origin</td></tr>
<tr><td>pppRefCrdY=</td><td>PPP Client: Y coordinate of plot origin</td></tr>
<tr><td>pppRefCrdZ=</td><td>PPP Client: Z coordinate of plot origin</td></tr>
<tr><td>nmeaFile=</td><td>PPP Client: NMEA outputfile</td></tr>
<tr><td>nmeaPort=</td><td>PPP Client: NMEA IP output port</td></tr>
</table>
</p>
<p>
Note that the following configuration options saved on disk can be changed/edited on-the-fly while BNC is already processing data:
</p>
<p>
<ul>
<li>'mountPoints' to change the selection of streams to be processed, see section 'Streams',</li>
<li>'waitTime' to change the 'Wait for full epoch' option, see section 'Feed Engine', and</li>
<li>'binSampl' to change the 'Sampling' option, see section 'Feed Engine'.</li>
</ul>
</p>

<p><a name="links"><h3>6.5 Links</h3></p>
<table>
<tr></tr>
<tr><td>NTRIP &nbsp;</td><td><u>http://igs.bkg.bund.de/ntrip/about</u></td></tr>
<tr><td>EUREF-IP NTRIP broadcaster &nbsp;</td><td><u>http://www.euref-ip.net/home</u></td></tr>
<tr><td>IGS-IP NTRIP broadcaster &nbsp;</td><td><u>http://www.igs-ip.net/home</u></td></tr>
<tr><td>IGS products NTRIP broadcaster &nbsp;</td><td><u>http://products.igs-ip.net/home</u></td></tr>
<tr><td>Distribution of IGS-IP streams &nbsp;</td><td><u>http://www.igs.oma.be/real_time/</u></td></tr>
<tr><td>Completeness and latency of IGS-IP data &nbsp;</td><td><u>http://www.igs.oma.be/highrate/</u></td></tr>
<tr><td>NTRIP broadcaster overview &nbsp;</td><td><u>http://www.rtcm-ntrip.org/home</u></td></tr>
<tr><td>NTRIP Open Source software code &nbsp;</td><td><u>http://software.rtcm-ntrip.org</u></td></tr>
<tr><td>EUREF-IP Project &nbsp;</td><td><u>http://www.epncb.oma.be/euref_IP</u></td></tr>
<tr><td>Real-time IGS Pilot Project &nbsp;</td><td><u>http://www.rtigs.net/pilot</u></td></tr>
<tr><td>Radio Technical Commission<br>for Maritime Services &nbsp;</td><td><u>http://www.rtcm.org</u>
</table>

