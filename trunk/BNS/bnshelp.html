<h3>BKG Ntrip Server (BNS) Version 1.0</h3>

<p>
The BKG Ntrip Server (BNS) is a program for generating real-time GNSS clock and orbit corrections to Broadcast Ephemeris in RTCM Version 3 format and upload the resulting stream to NTRIP broadcasters like <u>http://www.euref-ip.net/home</u> or <u>http://www.igs-ip.net/home</u>.
</p>
<p>
BNS has been developed for the Federal Agency for Cartography and Geodesy (BKG) within the framework of EUREF's Real-time GNSS Project (EUREF-IP, IP for Internet Protocol) and the Real-Time IGS Pilot Project (RTIGS).
</p>
<p>
BNS has been written under GNU General Public License (GPL). Binaries for BNS are available for Windows, 32-bit Linux, 64-bit Linux (compiled using option -m32), Solaris, and Mac systems. We used the MinGW Version 5.3.1 compiler to create the Windows binary. It is likely that BNS can be compiled on other systems where a GNU compiler and Qt Version 4.3.2 are installed.
</p>
<h3>Contents</h3>
<p>
<h4>
<a href=#purpose>1. Purpose</a><br>
<a href=#resources>2. Resources</a><br>
<a href=#options>3. Options</a><br>
<a href=#limits>4. Limitations</a><br>
<a href=#authors>5. Authors</a><br>
<a href=#annex>8. Annex</a><br>
</h4>
</p>

<p><a name="purpose"><h3>1. Purpose</h3></p>

<p> The purpose of BNS is to

<ul>
<li>read GNSS clock and orbit corrections in a plain ASCII format from an IP port of your local host. These corrections can be provided by a real-time GNSS engine like RTNet. They are expected to refer to the IGS Earth-Centered-Earth-Fixed (ECEF) reference system.</li> 
<li>read GNSS Broadcast Ephemeris in RINEX Navigation file format from an IP port of your local host. This information can be provided in real-time by the 'BKG Ntrip Client' (BNC) program.</li>
<li>convert the IGS Earth-Centered-Earth-Fixed clock and and orbit corrections into corrections to Broadcast Ephemeris with radial, along-track and cross-track components.</li>
<li>upload the stream of cock and orbit Broadcast Ephemeris corrections to an Ntrip Broadcaster.</li>
<li>save the Broadcast Ephemeris clock corrections in Clock RINEX files.</li>
<li>save the Broadcast Ephemeris orbit corrections in SP3 files.</li>
</ul>
</p>
<p>
Note that BNS so far only generates the tentative RTCM Version 3.x message types 4056 for Combined GPS and GLONASS orbit corrections and 4057 for Combined GPS and GLONASS clock corrections to Broadcast Ephemeris.
</p>

<p><a name="resources"><h3>2. Resources</h3></p>
<p>
BNS requires access to the Internet with a minimum of about 2 to 3 kbits/sec for stream upload to an Ntrip Broadcaster depending on the number of visible satellites. You need to make sure that the connection can sustain the required bandwidth.
</p>
<p>
Running BNS requires the clock of the host computer to be properly synchronized.
</p>

<p><a name="options"><h3>3. Options</h3></p>
<p>
3.1. <a href=#file>File</a><br>
3.2. <a href=#help>Help</a><br>
3.3. <a href=#proxy>Proxy</a><br>
3.4. <a href=#general>General</a><br>
&nbsp; &nbsp; &nbsp; 3.4.1. <a href=#logfile>Logfile</a><br>
&nbsp; &nbsp; &nbsp; 3.4.2. <a href=#appfile>Append Files</a><br>
3.5. <a href=#input>Input</a><br>
&nbsp; &nbsp; &nbsp; 3.5.1. <a href=#ephemeris>Ephemeris</a><br>
&nbsp; &nbsp; &nbsp; 3.5.2. <a href=#clocks>Clocks</a><br>
3.6. <a href=#caster>NTRIP Caster</a><br>
&nbsp; &nbsp; &nbsp; 3.6.1. <a href=#cashost>Host</a><br>
&nbsp; &nbsp; &nbsp; 3.6.2. <a href=#casport>Port</a><br>
&nbsp; &nbsp; &nbsp; 3.6.3. <a href=#casproxy>Use Proxy</a><br>
&nbsp; &nbsp; &nbsp; 3.6.4. <a href=#casmount>Mountpoint</a><br>
&nbsp; &nbsp; &nbsp; 3.6.5. <a href=#caspass>Password</a><br>
&nbsp; &nbsp; &nbsp; 3.6.6. <a href=#casdata>Data</a><br>
3.7. <a href=#clocks>RINEX Clocks</a><br>
&nbsp; &nbsp; &nbsp; 3.7.1. <a href=#clkdir>Directory</a><br>
&nbsp; &nbsp; &nbsp; 3.7.2. <a href=#clkint>Interval</a><br>
&nbsp; &nbsp; &nbsp; 3.7.3. <a href=#clksamp>Sampling</a><br>
3.8. <a href=#orbits>SP3 Orbits</a><br>
&nbsp; &nbsp; &nbsp; 3.8.1. <a href=#orbdir>Directory</a><br>
&nbsp; &nbsp; &nbsp; 3.8.2. <a href=#orbint>Interval</a><br>
&nbsp; &nbsp; &nbsp; 3.8.3. <a href=#orbsamp>Sampling</a><br>
3.9 <a href=#start>Start</a><br>
3.10. <a href=#stop>Stop</a><br>
3.11. <a href=#nw>No Window</a>
</p>

<p><a name="file"><h4>3.1. File</h4></p>

<p>
The 'File' button lets you
<ul>
<li>
select an appropriate font.<br>
Use smaller font size if the BNS main window exceeds the size of your screen.
</li> 
<li> save selected options.<br>
Note that on Windows systems options are saved in register BKG_NTRIP_Server. On Unix/Linux systems options are saved in file ${HOME}/.config/BKG/BKG_NTRIP_Server.conf.
</li>
<li>
quit the BNS program.
</li> 
</ul>
</p>

<p><a name="help"><h4>3.2. Help</h4></p>

<p>
The 'Help' button provides access to
<ul>
<li>
help contents.<br>
You may keep the 'Help Contents' window open while configuring BNS.
</li> 
<li>
general information about BNS.<br>
Close the 'About BNS' window to continue working with BNS.
</li> 
</ul>
</p>
<p>
BNS comes with a help system providing online information about its functionality and usage. Short descriptions are available for any widget. Focus to the relevant widget and press Shift+F1 to request help information. A help text appears immediately; it disappears as soon as the user does something else. The dialogs on some operating systems may provide a "?" button that users can click; they then click the relevant widget to pop up the help text.
</p>

<p><a name="proxy"><h4>3.3. Proxy - for usage in a protected LAN</h4></p>

<p>
If you are running BNS within a protected Local Area Network (LAN), you might need to use a proxy server to access the Internet. Enter your proxy server IP and port number in case one is operated in front of BNC. If you don't know the IP and port of your proxy server, check the proxy server settings in your Internet browser or ask your network administrator.</p>
<p>
Note that IP streaming is often not allowed in a LAN. In this case you need to ask your network administrator for an appropriate modification of the local security policy or for the installation of a TCP relay to the NTRIP broadcasters. If these are not possible, you might need to run BNS outside your LAN on a host that has unobstructed connection to the Internet.
</p>
<p><a name="general"><h4>3.4. General Options</h4></p>

<p><a name="logfile"><h4>3.4.1 Logfile - optional</h4></p>
<p>
Records of BNC's activities are shown in the Log section on the bottom of the main window. These logs can be saved into a file when a valid path is specified in the 'Log (full path)' field. The message log covers the communication status between BNC and the NTRIP broadcaster as well as problems that may occur in the communication link, stream availability, stream delay, stream conversion etc. All times are given in UTC. The default value for 'Log (full path)' is an empty option field, meaning that BNC logs will not saved into a file.
</p>

<p><a name="appfile"><h4>3.4.2 Append Files</h4></p>
<p>
When BNS is started, new files are created by default and any existing files with the same name will be overwritten. However, users might want to append existing files following a restart of BNS, a system crash or when BNS crashed. Tick 'Append files' to continue with existing files and keep what has been recorded so far. Note that option 'Append files' affects all types of files created by BNS.
</p> 

<p><a name="input"><h4>3.5. Input</h4></p>
<p>
BNS needs GNSS clock and orbit corrections in the IGS Earth-Centered-Earth-Fixed (ECEF) reference system and Broadcast Ephemeris in RINEX Navigation file format.
</p>

<p><a name="ephemeris"><h4>3.5.1 Ephemeris - mandatory</h4></p>
<p>
BNS reads GNSS Broadcast Ephemeris in RINEX Version3 Navigation file format from an IP address and port. This information can be provided in real-time by the 'BKG Ntrip Client' (BNC) program. Enter the respective servers IP address and port number. Make sure that this server is up and running before you start BNS. If a prosy server is operated between BNS and the server providing the Broadcast Ephemeris, you may need to use the proxy server settings you have specified. Tick 'Use proxy' to use it for stream upload.
</p>

<p><a name="clocks"><h4>3.5.2 Clocks - mandatory</h4></p>
<p>
BNS reads GNSS clock and orbit corrections in a plain ASCII format from an IP address and port. These corrections can be provided by a real-time GNSS engine like RTNet. They are expected to refer to the IGS Earth-Centered-Earth-Fixed (ECEF) reference system. Enter the respective servers IP address and port number. Make sure that this server is up and running. If a prosy server is operated between BNS and the server providing the clock and orbit corrections, you may need to use the proxy server settings you have specified. Tick 'Use proxy' to use it for stream upload.
</p>

<p><a name="caster"><h4>3.6. NTRIP Caster</h4></p>
<p>
BNS can upload the resulting stream of cock and orbit corrections (refering to Broadcast Ephemeris) to an Ntrip Broadcaster. For that EUREF and IGS operate NTRIP broadcasters at <u>http://www.euref-ip.net/home</u> and <u>http://www.igs-ip.net/home</u> which might be used for stream upload. The stream format follows RTCM Version 3 currently transmitting thentative message types 4056 and 4057.
</p> 

<p><a name="cashost"><h4>3.6.1 Host - optional</h4></p>
Enter the NTRIP broadcaster 'Host' IP name or number for stream upload. 
</p>

<p><a name="casport"><h4>3.6.2 Port - mandatory if 'Host' is set</h4></p>
<p>
Enter the NTRIP broadcaster IP 'Port' number for stream upload. Note that NTRIP Broadcaster installations often provide access through more than one port, usually ports 80 and 2101. In case you experience communication problems on port 80, you may like to use the alternative port(s).
</p>

<p><a name="casproxy"><h4>3.6.3 Use Proxy - optional if 'Host' and 'Proxy' is set</h4></p>
<p>
In case BNS is operated in a protected LAN, you may need to use the proxy server protecting your network. Once you have specified your proxies host and port, you can tick 'Use proxy' to use it for stream upload.
</p>

<p><a name="casmount"><h4>3.6.4 Mountpoint - mandatory if 'Host' is set</h4></p>
<p>
Each stream on an NTRIP broadcaster is defined using a unique source ID called mountpoint. An NTRIP server like BNS can upload its stream to the broadcaster by referring to a specific mountpoint established by the broadcaster operator. Specify the mountpoint you receive from the operator for your stream. Note that it usually is a four character ID (capital letters) plus an integer number.
</p>

<p><a name="caspass"><h4>3.6.5 Password - mandatory if 'Host' is set</h4></p>
<p>
In NTRIP Version 1.0 stream upload ist protected through a generic upload 'Password'. Enter the password you received from the broadcaster operator along with the mounpoint.
</p>

<p><a name="casdata"><h4>3.6.6 Data - optional</h4></p>
<p>
The clock and orbit corrections streamed by BNS to an NTRIP broadcaster can recorded. Specify the full 'Data' path here to save this information in a local file. Default value for 'Data' path is an empty option field, meaning that the upload stream contents will not be saved locally.
</p>
<p>
<ul>
<li>Mountpoint</li>
<li>GPS Week</li>
<li>Second in GPS Week</li>
<li>GNSS Indicator and Satellite Vehicle Pseudo Random Number</li>
<li>IOD refering to Broadcast Ephemeris set</li>
<li>Clock Correction to Broadcast Ephemeris [m]</li>
<li>Radial Component of Orbit Correction to Broadcast Ephemeris [m]</li>
<li>Along-track Component of Orbit Correction to Broadcast Ephemeris [m]</li>
<li>Cross-track Component of Orbit Correction to Broadcast Ephemeris [m]</li>
</ul>
</p>
<p>
<pre>
1487 547554.0 G27    57     12.219      1.241    0.495    0.002
1487 547554.0 G29   101     -0.086      0.008   -0.429    0.675
1487 461154.0 R06    18      5.192      2.390   -1.915   -6.734
1487 461154.0 R07    18     -1.619      2.827    0.901    0.280
1487 547554.0 G27    57     12.218      1.242    0.496    0.003
1487 547554.0 G29   101     -0.087      0.007   -0.427    0.673
1487 461154.0 R06    18      5.191      2.389   -1.914   -6.735
1487 461154.0 R07    18     -1.618      2.826    0.900    0.281
</pre>
</p>

<p><a name="rinex"><h4>3.7. RINEX Clocks</h4></p>
<p>
The clock corrections generated by BNS can be saved in Clock RINEX files. The file names follow the RINEX convention.
</p>

<p><a name="clkdir"><h4>3.7.1 Directory - optional</h4></p>
<p>
Here you can specify the path to where the Clock RINEX files will be stored. If the specified directory does not exist, BNC will not create Clock RINEX files. Default value for 'Directory' is an empty option field, meaning that no Clock RINEX files will be written.
</p>

<p><a name="clkint"><h4>3.7.2 Interval - mandatory if 'Directory' is set</h4></p>
<p>
Select the length of the Clock RINEX file generated. The default value is 1 day.
</p>

<p><a name="clksamp"><h4>3.7.3 Sampling - mandatory if 'Directory' is set</h4></p>
<p>
Select the Clock RINEX sampling interval in seconds. A value of zero '0' tells BNS to store all received epochs into Clock RINEX. This is the default value.
</p>

<p><a name="orbits"><h4>3.8. SP3 Orbits</h4></p>
<p>
The orbit corrections generated by BNS can be saved in SP3 orbit files. The file names follow the RINEX convention.
</p>

<p><a name="orbdir"><h4>3.8.1 Directory - optional</h4></p>
<p>
Here you can specify the path to where the SP3 orbit files will be stored. If the specified directory does not exist, BNC will not create SP3 orbit files. Default value for 'Directory' is an empty option field, meaning that no SP3 orbit files will be written.
</p>

<p><a name="orbint"><h4>3.8.2 Interval - mandatory if 'Directory' is set</h4></p>
<p>
Select the length of the SP3 orbit file generated. The default value is 1 day.
</p>

<p><a name="orbsamp"><h4>3.8.3 Sampling - mandatory if 'Directory' is set</h4></p>
<p>
Select the SP3 orbit file sampling interval in seconds. A value of zero '0' tells BNS to store all received epochs into SP3 orbit files. This is the default value.
</p>

<p><a name="start"><h4>3.9. Start</h4></p>
<p>
Hit 'Start' to start receiving IGS corbit and clock corrections and convert them into corrections to Broadcast Ephemeris. Note that 'Start' generally forces BNS to begin with fresh files which might overwrite existing files when necessary unless the option 'Append files' is ticked.
</p> 

<p><a name="stop"><h4>3.10. Stop</h4></p>
<p>
Hit the 'Stop' button in order to stop BNS. 
</p> 

<p><a name="nw"><h4>3.11. No Window - optional</h4></p>
<p>
On all systems BNS can be started in batch mode with the command line option '-nw'. BNS will then run in 'no window' mode, using options from the configuration file ${HOME}/.config/BKG/BNC_NTRIP_Server.conf (Unix/Linux, see Config File example in the Annex) or from the register BKG_NTRIP_Server (Windows).
</p>
<p>
Note that the self-explaining contents of the configuration file or the Windows register can easily be edited. Terminate BNS using Windows Task Manager when running it in 'no window' mode on Windows systems.
</p> 
<p><a name="limits"><h3>4. Limitations</h3></p>
<ul>
<li>
In Qt-based desktop environments (like KDE) on Unix/Linux platforms it may happen that you experience a crash of BNS at startup even when running the program in the background using the '-nw' option. This is a known bug most likely resulting from an incompatibility of Qt libraries in the environment and in BNS. Entering the command 'unset SESSION_MANAGER' before running BNS may help as a work-around. 
</li>
<li>
Currently BNS will only generate the tentative RTCM Version 3.x message types 4056 and 4057.
</li>
<li>
We experienced a limitation of the Standard Version of Microsoft Windows related to socket communication where sockets are not always handled properly. Since BNS makes intensive use of communication through sockets, we recommend to use the Server Version of Microsoft Windows when running BNS continuously for extended on a Windows platform.
</li>
<li>
Once BNS has been started, its configuration can not be changed as long as it is stopped. A reconfiguration on-the-fly is not implemented.
</li>
<br>
</ul>
<p><a name="authors"><h3>5. Authors</h3></p>
<p>
The BKG Ntrip Server (BNS) Qt Graphic User Interface (GUI) has been developed for the Federal Agency for Cartography and Geodesy (BKG) by Leos Mervart, Czech Technical University Prague, Department of Geodesy. BNS includes a GNU GPL open source RTCM 3.x encoder, written for BKG by Dirk Stoecker, Alberding GmbH, Schoenefeld.
</p>
<p>
Please ensure that you have installed the latest version of BNS available from <u>http://igs.bkg.bund.de/index_ntrip_down.htm</u>. We are continuously working on the program and would appreciate if you could send any comments, suggestions, or bug reports to:
</p>
<p>
Georg Weber<br>
Federal Agency for Cartography and Geodesy (BKG)<br>
Frankfurt, Germany<br>
euref-ip@bkg.bund.de or igs-ip@bkg.bund.de
</p>

<p><a name="annex"><h3>6. Annex</h3></p>
<p>
6.1. <a href=#history>History</a><br>
6.2. <a href=#ntrip>NTRIP</a><br>
6.3. <a href=#rtcm>RTCM</a><br>
&nbsp; &nbsp; &nbsp; 6.3.1 RTCM <a href=#rtcm3> Version 3.x</a><br>
6.4. <a href=#config>Config File</a><br>
6.5. <a href=#links>Links</a><br>
</p>

<p><a name=history><h3>6.1 History</h3></p>
<table>
<tr></tr>
<tr><td>August 2008 &nbsp;</td><td>Version 1.0 &nbsp;</td><td>[Add] First Beta Binaries published based on Qt 4.2.3.</td></tr>
</table>
</p>

<p><a name="ntrip"><h4>6.2. NTRIP</h4></p>

<p>
'Networked Transport of RTCM via Internet Protocol' Version 1.0 (NTRIP) stands for an application-level protocol streaming Global Navigation Satellite System (GNSS) data over the Internet. NTRIP is a generic, stateless protocol based on the Hypertext Transfer Protocol HTTP/1.1. The HTTP objects are enhanced to GNSS data streams.
</p>

<p>
NTRIP Version 1.0 is an RTCM standard designed for disseminating differential correction data (e.g. in the RTCM-104 format) or other kinds of GNSS streaming data to stationary or mobile users over the Internet, allowing simultaneous PC, Laptop, PDA, or receiver connections to a broadcasting host. NTRIP supports wireless Internet access through Mobile IP Networks like GSM, GPRS, EDGE, or UMTS.
</p>

<p>
NTRIP is implemented in three system software components: NTRIP clients, NTRIP servers and NTRIP broadcasters. The NTRIP broadcaster is the actual HTTP server program whereas NTRIP client and NTRIP server are acting as HTTP clients. The NTRIP broadcaster maintains a source-table containing information on available NTRIP streams, networks of NTRIP streams and NTRIP broadcasters. The source-table is sent to an NTRIP client on request.
</p>

<p>
NTRIP is an open none-proprietary protocol. Major characteristics of NTRIP's dissemination technique are:
<ul>
<li>Based on the popular HTTP streaming standard; comparatively easy to implement when having limited client and server platform resources available.</li>
<li>Application not limited to one particular plain or coded stream content; ability to distribute any kind of GNSS data.</li>
<li>Potential to support mass usage; disseminating hundreds of streams simultaneously for thousands of users possible when applying modified Internet Radio broadcasting software.</li>
<li>Considering security needs; stream providers and users don't necessarily get into contact, streams often not blocked by firewalls or proxy servers protecting Local Area Networks.</li>
<li>Enables streaming over mobile IP networks because of using TCP/IP.</li>
</ul>
</p>

<p>
</p>

<p><a name="rtcm"><h4>6.3. RTCM</h4></p>

<p>
The Radio Technical Commission for Maritime Services (RTCM) is an international non-profit scientific, professional and educational organization. Special Committees provide a forum in which governmental and non-governmental members work together to develop technical standards and consensus recommendations in regard to issues of particular concern. RTCM is engaged in the development of international standards for maritime radionavigation and radiocommunication systems. The output documents and reports prepared by RTCM Committees are published as RTCM Recommended Standards. Topics concerning Differential Global Navigation Satellite Systems (DGNSS) are handled by the Special Committee SC 104.
<p>
Personal copies of RTCM Recommended Standards can be ordered through <u>http://www.rtcm.org/orderinfo.php</u>.
</p>

<p><a name="rtcm3"><h4>6.3.1 RTCM Version 3.x</h4></p>
<p>
RTCM Version 3.x has been developed as a stream format alternative to RTCM Version 2.x. Service providers and vendors have asked for a standard that would be efficient, easy to use, and easily adaptable to new situations. 
</p>

<p>
RTCM is in the process of developing new Version 3 messages types to transport satellite clock and orbit corrections in real-time. Based on the latest available proposal, the following tentative messages currently under discussion are of interest here:
<ul>
<li>Message type 4050: GPS orbit corrections to Broadcast Ephemeris</li>
<li>Message type 4051: GPS clock corrections to Broadcast Ephemeris</li>
<li>Message type 4052: GPS code biases</li>
<li>Message type 4053: GLONASS orbit corrections to Broadcast Ephemeris</li>
<li>Message type 4054: GLONASS clock corrections to Broadcast Ephemeris</li>
<li>Message type 4055: GLONASS code biases</li>
<li>Message type 4056: Combined GPS and GLONASS orbit corrections to Broadcast Ephemeris</li>
<li>Message type 4057: Combined GPS and GLONASS clock corrections to Broadcast Ephemeris</li>
</ul>
</p>
<p>
RTCM Version 3 streams carrying these messages may be used i.e. to support real-time Precise Point Positioning (PPP) applications following the 'state space' approach.
</p>

<p><a name="config"><h4>6.4. Config File</h4></p>
<p>
The following is an example for the contents of a Unix/Linux configuration file ${HOME}/.config/BKG/BKG_NTRIP_Client.conf. It enables the upload of stream CLCK1 to www.euref-ip.net. Clock RINEX files and SP3 orbit files are uploaded to a directory /home/weber/rinex :
<pre>
[General]
clkPort=2067
ephPort=2066
logFile=/home/weber/rinex/log.txt
mountpoint=CLCK1
outFile=/home/weber/rinex/data.txt
outHost=www.igs-ip.net
outPort=2101
password=uploadpass
rnxIntr=1 day
rnxPath=/home/weber/rinex
rnxSampl=0
sp3Intr=1 day
sp3Path=/home/weber/rinex
sp3Sampl=0
</pre>
</p>

<p><a name="links"><h3>6.5 Links</h3></p>
<table>
<tr></tr>
<tr><td>NTRIP &nbsp;</td><td><u>http://igs.bkg.bund.de/index_ntrip.htm</u></td></tr>
<tr><td>EUREF-IP NTRIP broadcaster &nbsp;</td><td><u>http://www.euref-ip.net/home</u></td></tr>
<tr><td>IGS-IP NTRIP broadcaster &nbsp;</td><td><u>http://www.igs-ip.net/home</u></td></tr>
<tr><td>NTRIP broadcaster overview &nbsp;</td><td><u>http://www.rtcm-ntrip.org/home</u></td></tr>
<tr><td>EUREF-IP Project &nbsp;</td><td><u>http://www.epncb.oma.be/euref_IP</u></td></tr>
<tr><td>Real-time IGS Pilot Project &nbsp;</td><td><u>http://www.rtigs.net/pilot</u></td></tr>
<tr><td>Radio Technical Commission<br>for Maritime Services &nbsp;</td><td><u>http://www.rtcm.org</u>
</table>


